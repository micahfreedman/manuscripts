ylab("Wing Loading (Total Mass (mg) / Forewing Area (cm^2))")+
theme(axis.title.y = element_text(size=16))+
theme(legend.text = element_text(size=16), legend.position = 'bottom'))
wl.heritability <- lmer(wing.loading ~ (1|maternal_family), adults)
as.data.frame(VarCorr(wl.heritability))$vcov[1] / sum(as.data.frame(VarCorr(wl.heritability))$vcov) #broad sense heritability for wing loading is 0.231
thor.ab <- read.csv(file = './thorax_abdomen_mass.csv')
tsx <- merge(thor.ab, adults, by = 'Cat.ID')
tsx$drymass <- tsx$thorax + tsx$abdomen
plot(drymass ~ emergence_weight, tsx) #clearly very tightly correlated, so probably not worth adding another plot explicitly for dry mass
tsx$ab.thor.ratio <- tsx$thorax / tsx$abdomen
loc.ad.thor.ab <- lmer(ab.thor.ratio ~ Species + Mon.Pop + sym.allo + (1|Pop/Plant.ID) + (1|maternal_family) + GH + scale(OE) + Sex.y, data = tsx[tsx$fresh == 'yes',])
Anova(loc.ad.thor.ab) #species differ, more modest differences among sex and monarch populations; strong effect of OE, whereby it decreases thorax mass more strongly than abdominal mass (makes sense in the context of transmission dynamics -- should favor reproduction and vertical transmission but not dispersal)
summary(glht(loc.ad.thor.ab, linfct = mcp(Mon.Pop = "Tukey"))) #no significant pairwise differences among populations
summary(glht(loc.ad.thor.ab, linfct = mcp(Species = "Tukey")))
plot.tsx <- tsx[tsx$fresh=='yes',] #restrict to only individuals that were collected on the same day that they eclosed for plotting (same data was used for analysis above)
(figs2d=ggplot(plot.tsx[!is.na(plot.tsx$Mon.Pop),], aes(x = Mon.Pop, y = ab.thor.ratio))+
geom_point(aes(col = Mon.Pop), position = position_jitterdodge(3.2), size = 1.7)+
geom_boxplot(outlier.size = 0, outlier.color = 'white', alpha = 0.5, size = 0.7)+
theme_classic()+
theme(axis.title.x = element_blank(), axis.text.y = element_text(size = 16))+
stat_summary(fun.data = give.n, geom = "text", vjust = 2, size = 5)+
theme(axis.ticks = element_blank(),axis.text.x = element_blank())+
theme(legend.title=element_blank() )+
scale_color_viridis_d()+
guides(colour = guide_legend(override.aes = list(size=3)))+
ylab("Thorax Mass / Abdomen Mass")+
theme(axis.title.y = element_text(size=16))+
theme(legend.text = element_text(size=16), legend.position = 'bottom'))
abthor.heritability <- lmer(ab.thor.ratio ~ (1|maternal_family), tsx)
as.data.frame(VarCorr(abthor.heritability))$vcov[1] / sum(as.data.frame(VarCorr(abthor.heritability))$vcov) #broad sense heritability for abdomen to thorax ratio is 0.094
adults_manova_model1 <- manova(cbind(Size.PC1, Shape.PC1, emergence_weight) ~ Species + Mon.Pop + sym.allo + (OE) + Sex + Error(maternal_family), data = adults)
summary(adults_manova_model1)
adults_manova_model2 <- manova(cbind(Size.PC1, Shape.PC1, emergence_weight, ab.thor.ratio) ~ Species + Mon.Pop + sym.allo + (OE) + Sex.x + Error(maternal_family), data = tsx)
summary(adults_manova_model2)
adults$wing.loading <- adults$emergence_weight / adults$MArea
names(adults)
names(thor.ab)
corr.all.adult <- merge(adults, thor.ab[thor.ab$fresh=='yes',], by = 'Cat.ID', all = T)
names(corr.all.adult)
corr.all.adult$thor.ab.ratio <- corr.all.adult$thorax/corr.all.adult$abdomen
corr.all.adult$dry.mass <- corr.all.adult$thorax + corr.all.adult$abdomen
names.keep <- c('Cat.ID','Year','Species','Mon.Pop','Size.PC1','Shape.PC1','wing.loading','Sex.y','thorax','abdomen','emergence_weight')
names.keep2 <- c('Size.PC1','Shape.PC1','wing.loading','thorax','abdomen','emergence_weight','dry.mass','thor.ab.ratio')
full.names.cor <- c('MLength','MWidth','MArea','roundness','aspect_ratio','Size.PC1','Shape.PC1','emergence_weight','dry.mass','wing.loading','thorax','abdomen','thor.ab.ratio')
emb <- na.omit(corr.all.adult[,names.keep2])
names(emb) <- c('Size PC1', 'Shape PC1', 'Wing Loading','Thorax Mass', 'Abdomen Mass','Total Mass', 'Total Mass (Dry)', 'Thorax to Abdomen Ratio')
emb <- emb[,c(1,2,6,7,3,4,5,8)]
M <- cor(emb)
library(corrplot)
corrplot(M, method = 'circle')
library(PerformanceAnalytics)
chart.Correlation(emb)
dmc <- na.omit(corr.all.adult[,full.names.cor])
names(dmc) <- c('Forewing Length', 'Forewing Width', 'Forewing Area','Forewing Roundness','Aspect Ratio','Size PC1','Shape PC1','Total Mass','Total Mass (Dry)','Wing Loading','Thorax Mass','Abdomen Mass','Thorax to Abdomen Ratio')
chart.Correlation(dmc)
N = cor(dmc)
figs3a <- corrplot(N, method = 'circle')
earlies <- wings[c(which(wings$Country.Archipelago=='Marianas' & wings$year < 1938),which(wings$Country.Archipelago == 'Australia' & wings$Region=='Pacific Islands' & wings$year < 1922),which(wings$Country.Archipelago == 'Samoa' & wings$year < 1919),which(wings$Country.Archipelago == 'New_Guinea' & wings$year < 1926),which(wings$Country.Archipelago == 'Hawaii' & wings$year < 1901),which(wings$Country.Archipelago == 'Fiji' & wings$year < 1917),which(wings$Country.Archipelago =='New_Caledonia' & wings$year < 1919),which(wings$Country.Archipelago =='Morocco' & wings$year < 1937),which(wings$Country.Archipelago == 'French_Polynesia' & wings$year < 1933),which(wings$Country.Archipelago == 'Indonesia' & wings$year < 1921),which(wings$Country.Archipelago == 'Tonga' & wings$year < 1914),which(wings$Country.Archipelago == 'Vanuatu' & wings$year < 1919),which(wings$Country.Archipelago == 'Solomon_Islands' & wings$year < 1937),which(wings$Country.Archipelago == 'Taiwan' & wings$year < 1940),which(wings$Country.Archipelago == 'Marquesas' & wings$year < 1934),which(wings$Region == 'North America' & wings$year < 1921),which(wings$Country.Archipelago == 'British_Isles'),which(wings$Country.Archipelago =='Madeira' & wings$year < 1900), which(wings$Country.Archipelago=='Azores' & wings$year < 1910)),] #notably, nothing to include for New Zealand, Spain, Morocco, Portugal, Cape Verde, Micronesia
nrow(earlies)
levels(earlies$Region) <- c(levels(earlies$Region),'British Isles')
earlies[which(earlies$Country.Archipelago == 'British_Isles'),]$Region <- 'British Isles'
early.means.size <- aggregate(Size.PC1 ~ Region, earlies, mean)
names(early.means.size)[2] <- 'mean.size'
early.means.shape <- aggregate(Shape.PC1 ~ Region, earlies, mean)
names(early.means.shape)[2] <- 'mean.shape'
early.se.size <- aggregate(Size.PC1 ~ Region, earlies, function(x) sd(x)/sqrt(length(x)))
names(early.se.size)[2] <- 'size.se'
early.se.shape <- aggregate(Shape.PC1 ~ Region, earlies, function(x) sd(x)/sqrt(length(x)))
names(early.se.shape)[2] <- 'shape.se'
early.size <- merge(early.means.size, early.se.size)
early.shape <- merge(early.means.shape, early.se.shape)
plot.early <- merge(early.size, early.shape, by  = 'Region')
plot.early$Region <- factor(plot.early$Region, levels = c('North America','Atlantic','Pacific Islands','British Isles'))
(fig2a <- ggplot(plot.early[which(plot.early$Region %in% c('North America','Pacific Islands','Atlantic','British Isles')),], aes(x = mean.size, y = mean.shape, group = Region, col = Region))+
theme_bw()+
geom_point(size = 3)+
geom_errorbar(aes(ymin = mean.shape - shape.se, ymax = mean.shape + shape.se), size = 0.5, width = 0.02)+
geom_errorbarh(aes(xmin = mean.size - size.se, xmax = mean.size + size.se), size = 0.5, height = 0.02)+
scale_color_manual(name="Region",values=
c("limegreen","purple",'blue','black'))+
guides(colour = guide_legend(override.aes = list(size=3)))+
ylab("Shape PC1")+
xlab('Size PC1')+
theme(axis.title = element_text(size=16))+
theme(legend.text = element_text(size=16))+
theme(axis.text = element_text(size = 16))+
theme(legend.title = element_blank(), legend.position = c(0.79,0.15))+
theme(legend.background = element_rect(colour = 'black', fill = 'white'))+
geom_hline(yintercept = 0, lty = 2)+
geom_vline(xintercept = 0, lty = 2))
pdf('./Second submission/figures/Figure_range.expansion.pdf', width = 5.5, height = 5)
pdf(file = './Second submission/figures/Figure_range.expansion.pdf', width = 5.5, height = 5)
figs3a <- corrplot(N, method = 'circle')
pdf(file = './Second submission/figures/figs3a.pdf', height = 5, width = 5)
pdf(file = '~/Documents/grad_school/Manuscripts/Global wing morphology/Second submission/figures/Figure_range.expansion.pdf', width = 5.5, height = 5)
earlies$Region <- relevel(earlies$Region, ref = 'North America')
fig2a
dev.off()
earlies$Region <- relevel(earlies$Region, ref = 'North America')
earlies$expansion <- ifelse(earlies$Region =='North America','ancestral','expansion')
summary(lm(Size.PC1 ~ Region + Sex + year , earlies))
summary(lm(Shape.PC1 ~ Region + Sex + year, earlies)) #this works for quick analysis, but better approach might be to use parameters estimated from global models to account for various things like collection ID
library(cvequality)
with(na.omit(wings[!wings$Region %in% c('Asia','Indian_Ocean'),c('MArea','Region')]), asymptotic_test(x = MArea, y = droplevels(Region))) #confirms that CVs do differ between locations; can try pairwise comparisons
library(cvcqv)
cv_versatile(
adults[adults$Mon.Pop=='Eastern North America',]$MArea,
na.rm = TRUE,
digits = 3,
method = "basic",
correction = TRUE,
alpha = 0.05
)
cv_versatile(
wings[wings$Region=='North America',]$MArea,
na.rm = TRUE,
digits = 3,
method = "basic",
correction = TRUE,
alpha = 0.05
)
wild_coef.vars.area <- list()
for(i in 1:length(levels(wings.plot$Region))){
wild_coef.vars.area[i] <- cv_versatile(
wings.plot[which(wings.plot$Region ==
levels(wings.plot$Region)[i]),]$MArea,
na.rm = TRUE,
digits = 3,
method = "basic",
correction = TRUE,
alpha = 0.05
)[2]
}
names(wild_coef.vars.area) <- levels(wings.plot$Region)
wild_coef.vars.area<- ldply(wild_coef.vars.area)
wild_coef.vars.area$.id <- factor(wild_coef.vars.area$.id, levels = c('North America','Central America','South America','Caribbean','Pacific Islands','Atlantic'))
ggplot(wild_coef.vars.area, aes(x = .id, y = est, col = .id))+
theme_bw()+
geom_point(size = 3)+
geom_errorbar(aes(ymax = upper, ymin = lower), width = 0.2, size = 1)+
theme(legend.position = 'none')+
theme(axis.text = element_text(size = 14), axis.title = element_text(size = 14))+
scale_color_manual(values = c('limegreen','gold','brown1','orange','blue','purple'))+
theme(axis.text.x = element_text(angle = 60,hjust = 1), axis.title.x = element_blank())+
ylab('Coefficient of Variation - Forewing Area')
(fig4a <- ggplot(presentation1[!is.na(presentation1$Country.Archipelago),], aes(x=year,y=Size.PC1))+
geom_point(col = 'blue')+
theme_classic()+
facet_grid(~Country.Archipelago)+
stat_smooth(method = 'lm', fill = 'blue',col="black",alpha=0.25,fullrange=F)+
xlab("Year")+
ylab("Size PC1")+
theme(axis.title.x=element_text(size=16),axis.title.y=element_text(size=16))+
theme(strip.text.x = element_text(size = 14))+
theme(axis.text.x = element_text(size = 12),axis.text.y = element_text(size=16))+
geom_hline(yintercept = mean(North_America$Size.PC1, na.rm=T), lty = 2)+
geom_hline(yintercept = mean(Caribbean$Size.PC1, na.rm=T), lty =2)+
scale_x_continuous(limits = c(1840,2025))+
geom_vline(aes(xintercept = establishment.year), col = 'red', lty = 2, size = 0.5)+
ggtitle('Pacific Islands')+
theme(plot.title = element_text(hjust = 0.5, size = 20)))
ggplot(wings.plot[!is.na(wings.plot$Region),], aes(x=Region,y=Size.PC1))+
geom_point(aes(col = Region), position = position_jitterdodge(3.2), size = 1)+
geom_boxplot(outlier.size = 0, outlier.color = 'white', alpha = 0, size = 0.7)+
theme_classic()+
theme(axis.title.x = element_blank(), axis.text.y = element_text(size = 16))+
stat_summary(fun.data = give.n, geom = "text", vjust = 1)+
theme(axis.ticks = element_blank(),axis.text.x = element_blank())+
theme(legend.title=element_blank())+
scale_color_manual(name="Region",values=c("limegreen","gold","brown1","orange","blue",'purple'))+
guides(colour = guide_legend(override.aes = list(size=3)))+
ylab("Size PC1")+
theme(axis.title.y = element_text(size=16))+
theme(legend.text = element_text(size=16))
ggplot(wings.plot[!is.na(wings.plot$Region) & wings.plot$Shape.PC1 <4,], aes(x=Region,y=Shape.PC1))+
geom_point(aes(col = Region), position = position_jitterdodge(3.2), size = 1)+
geom_boxplot(outlier.size = 0, outlier.color = 'white', alpha = 0.6,outlier.alpha=0,size = 0.7)+
theme_classic()+
theme(axis.title.x = element_blank(), axis.text.y = element_text(size = 16))+
stat_summary(fun.data = give.n, geom = "text", vjust = 2)+
theme(axis.ticks = element_blank(),axis.text.x = element_blank())+
theme(legend.title=element_blank(), )+
scale_color_manual(name="Region",values=c("limegreen","gold","brown1","orange","blue",'purple'))+
guides(colour = guide_legend(override.aes = list(size=3)))+
ylab("Shape PC1")+
theme(axis.title.y = element_text(size=16))+
theme(legend.text = element_text(size=16)) #lots of elongated outliers among Pacific populations
ggplot(wings.plot[!is.na(wings.plot$Region) & wings.plot$Shape.PC1 <8,], aes(x=Size.PC1,y=Shape.PC1))+
geom_jitter(aes(col = Region), size = 0.5, alpha = 0.3)+
theme_classic()+
stat_ellipse(aes(col = Region), size = 1, lty = 1, level = 0.95)+
theme(axis.text = element_text(size = 16))+
theme(axis.title = element_text(size = 16))+
theme(legend.title=element_blank(), )+
scale_color_manual(name="Region",values=c("limegreen","gold","brown1","orange","blue",'purple'))+
guides(colour = guide_legend(override.aes = list(size=2)))+
xlab('Size PC1')+
ylab("Shape PC1")+
theme(axis.title.y = element_text(size=16))+
theme(legend.text = element_text(size=16))+
geom_hline(yintercept = 0, lty = 2)+
geom_vline(xintercept = 0, lty = 2)+
theme(legend.justification = 'top')+
ylim(c(-2,3)) #note: for purposes of display, dataset does not include extreme shape outliers from the Pacific
ggplot(wings.plot[!is.na(wings.plot$Region) & wings.plot$Shape.PC1 <8,], aes(x=Size.PC1,y=Shape.PC1))+
geom_jitter(aes(col = Region), size = 0.5, alpha = 0.3)+
theme_bw()+
stat_ellipse(aes(col = Region), size = 1, lty = 1, level = 0.95)+
theme(axis.text = element_text(size = 16))+
theme(axis.title = element_text(size = 16))+
theme(legend.title=element_blank(), )+
scale_color_manual(name="Region",values=c("limegreen","gold","brown1","orange","blue",'purple'))+
guides(colour = guide_legend(override.aes = list(size=2)))+
xlab('Size PC1')+
ylab("Shape PC1")+
theme(axis.title.y = element_text(size=16))+
theme(legend.text = element_text(size=16))+
geom_hline(yintercept = 0, lty = 2)+
geom_vline(xintercept = 0, lty = 2)+
theme(legend.justification = 'top')+
ylim(c(-2,3)) #note: for purposes of display, dataset does not include extreme shape outliers from the Pacific
wings[wings$Index == 4012,]
wings[wings$Index %in% c(4012,4252),]
(fig3 <- ggplot(wings.plot[!is.na(wings.plot$Region) & wings.plot$Shape.PC1 <8,], aes(x=Size.PC1,y=Shape.PC1))+
geom_jitter(aes(col = Region), size = 0.5, alpha = 0.3)+
theme_bw()+
stat_ellipse(aes(col = Region), size = 1, lty = 1, level = 0.95)+
theme(axis.text = element_text(size = 16))+
theme(axis.title = element_text(size = 16))+
theme(legend.title=element_blank(), )+
scale_color_manual(name="Region",values=c("limegreen","gold","brown1","orange","blue",'purple'))+
guides(colour = guide_legend(override.aes = list(size=2)))+
xlab('Size PC1')+
ylab("Shape PC1")+
theme(axis.title.y = element_text(size=16))+
theme(legend.text = element_text(size=16))+
geom_hline(yintercept = 0, lty = 2)+
geom_vline(xintercept = 0, lty = 2)+
theme(legend.justification = 'top')+
ylim(c(-2,3))) #note: for purposes of display, dataset does not include extreme shape outliers from the Pacific
fig3 + ggplot(data = wings[wings$Index %in% c(4012,4252),], aes(x = Size.PC1, y = Shape.PC1))+
geom_point(size = 1)+
scale_color_manual(values = c('brown1','limegreen'))
data = wings[wings$Index %in% c(4012,4252),]
fig3 + ggplot(data, aes(x = Size.PC1, y = Shape.PC1))+
geom_point(size = 1)+
scale_color_manual(values = c('brown1','limegreen'))
rlang::last_error()
ggplot(wings.plot[!is.na(wings.plot$Region) & wings.plot$Shape.PC1 <8,], aes(x=Size.PC1,y=Shape.PC1))+
geom_jitter(aes(col = Region), size = 0.5, alpha = 0.3)+
theme_bw()+
stat_ellipse(aes(col = Region), size = 1, lty = 1, level = 0.95)+
theme(axis.text = element_text(size = 16))+
theme(axis.title = element_text(size = 16))+
theme(legend.title=element_blank(), )+
scale_color_manual(name="Region",values=c("limegreen","gold","brown1","orange","blue",'purple'))+
guides(colour = guide_legend(override.aes = list(size=2)))+
xlab('Size PC1')+
ylab("Shape PC1")+
theme(axis.title.y = element_text(size=16))+
theme(legend.text = element_text(size=16))+
geom_hline(yintercept = 0, lty = 2)+
geom_vline(xintercept = 0, lty = 2)+
theme(legend.justification = 'top')+
ylim(c(-2,3)) #note: for purposes of display, dataset does not include extreme shape outliers from the Pacific
ggplot(wings.plot[!is.na(wings.plot$Region) & wings.plot$Shape.PC1 <8,], aes(x=Size.PC1,y=Shape.PC1))+
geom_jitter(aes(col = Region), size = 0.5, alpha = 0.3)+
theme_bw()+
stat_ellipse(aes(col = Region), size = 1, lty = 1, level = 0.95)+
theme(axis.text = element_text(size = 16))+
theme(axis.title = element_text(size = 16))+
theme(legend.title=element_blank(), )+
scale_color_manual(name="Region",values=c("limegreen","gold","brown1","orange","blue",'purple'))+
guides(colour = guide_legend(override.aes = list(size=2)))+
xlab('Size PC1')+
ylab("Shape PC1")+
theme(axis.title.y = element_text(size=16))+
theme(legend.text = element_text(size=16))+
geom_hline(yintercept = 0, lty = 2)+
geom_vline(xintercept = 0, lty = 2)+
theme(legend.justification = 'top')+
ylim(c(-2,3))+
geom_point(data = wings[wings$Index %in% c(4012,4252),], color = c('brown1','limegreen'))
ggplot(wings.plot[!is.na(wings.plot$Region) & wings.plot$Shape.PC1 <8,], aes(x=Size.PC1,y=Shape.PC1))+
geom_jitter(aes(col = Region), size = 0.5, alpha = 0.3)+
theme_bw()+
stat_ellipse(aes(col = Region), size = 1, lty = 1, level = 0.95)+
theme(axis.text = element_text(size = 16))+
theme(axis.title = element_text(size = 16))+
theme(legend.title=element_blank(), )+
scale_color_manual(name="Region",values=c("limegreen","gold","brown1","orange","blue",'purple'))+
guides(colour = guide_legend(override.aes = list(size=2)))+
xlab('Size PC1')+
ylab("Shape PC1")+
theme(axis.title.y = element_text(size=16))+
theme(legend.text = element_text(size=16))+
geom_hline(yintercept = 0, lty = 2)+
geom_vline(xintercept = 0, lty = 2)+
theme(legend.justification = 'top')+
ylim(c(-2,3))+
geom_point(data = wings[wings$Index %in% c(4012,4252),], color = c('brown1','limegreen'), size = 2)
ggplot(wings.plot[!is.na(wings.plot$Region) & wings.plot$Shape.PC1 <8,], aes(x=Size.PC1,y=Shape.PC1))+
geom_jitter(aes(col = Region), size = 0.5, alpha = 0.3)+
theme_bw()+
stat_ellipse(aes(col = Region), size = 1, lty = 1, level = 0.95)+
theme(axis.text = element_text(size = 16))+
theme(axis.title = element_text(size = 16))+
theme(legend.title=element_blank(), )+
scale_color_manual(name="Region",values=c("limegreen","gold","brown1","orange","blue",'purple'))+
guides(colour = guide_legend(override.aes = list(size=2)))+
xlab('Size PC1')+
ylab("Shape PC1")+
theme(axis.title.y = element_text(size=16))+
theme(legend.text = element_text(size=16))+
geom_hline(yintercept = 0, lty = 2)+
geom_vline(xintercept = 0, lty = 2)+
theme(legend.justification = 'top')+
ylim(c(-2,3))+
geom_point(data = wings[wings$Index %in% c(4012,4252),], color = c('brown1','limegreen'), size = 2,pch=21)
ggplot(wings.plot[!is.na(wings.plot$Region) & wings.plot$Shape.PC1 <8,], aes(x=Size.PC1,y=Shape.PC1))+
geom_jitter(aes(col = Region), size = 0.5, alpha = 0.3)+
theme_bw()+
stat_ellipse(aes(col = Region), size = 1, lty = 1, level = 0.95)+
theme(axis.text = element_text(size = 16))+
theme(axis.title = element_text(size = 16))+
theme(legend.title=element_blank(), )+
scale_color_manual(name="Region",values=c("limegreen","gold","brown1","orange","blue",'purple'))+
guides(colour = guide_legend(override.aes = list(size=2)))+
xlab('Size PC1')+
ylab("Shape PC1")+
theme(axis.title.y = element_text(size=16))+
theme(legend.text = element_text(size=16))+
geom_hline(yintercept = 0, lty = 2)+
geom_vline(xintercept = 0, lty = 2)+
theme(legend.justification = 'top')+
ylim(c(-2,3))+
geom_point(data = wings[wings$Index %in% c(4012,4252),], color = c('brown1','limegreen'), size = 2,pch=22)
ggplot(wings.plot[!is.na(wings.plot$Region) & wings.plot$Shape.PC1 <8,], aes(x=Size.PC1,y=Shape.PC1))+
geom_jitter(aes(col = Region), size = 0.5, alpha = 0.3)+
theme_bw()+
stat_ellipse(aes(col = Region), size = 1, lty = 1, level = 0.95)+
theme(axis.text = element_text(size = 16))+
theme(axis.title = element_text(size = 16))+
theme(legend.title=element_blank(), )+
scale_color_manual(name="Region",values=c("limegreen","gold","brown1","orange","blue",'purple'))+
guides(colour = guide_legend(override.aes = list(size=2)))+
xlab('Size PC1')+
ylab("Shape PC1")+
theme(axis.title.y = element_text(size=16))+
theme(legend.text = element_text(size=16))+
geom_hline(yintercept = 0, lty = 2)+
geom_vline(xintercept = 0, lty = 2)+
theme(legend.justification = 'top')+
ylim(c(-2,3))+
geom_point(data = wings[wings$Index %in% c(4012,4252),], color = c('brown1','limegreen'), size = 2,pch=20)
ggplot(wings.plot[!is.na(wings.plot$Region) & wings.plot$Shape.PC1 <8,], aes(x=Size.PC1,y=Shape.PC1))+
geom_jitter(aes(col = Region), size = 0.5, alpha = 0.3)+
theme_bw()+
stat_ellipse(aes(col = Region), size = 1, lty = 1, level = 0.95)+
theme(axis.text = element_text(size = 16))+
theme(axis.title = element_text(size = 16))+
theme(legend.title=element_blank(), )+
scale_color_manual(name="Region",values=c("limegreen","gold","brown1","orange","blue",'purple'))+
guides(colour = guide_legend(override.aes = list(size=2)))+
xlab('Size PC1')+
ylab("Shape PC1")+
theme(axis.title.y = element_text(size=16))+
theme(legend.text = element_text(size=16))+
geom_hline(yintercept = 0, lty = 2)+
geom_vline(xintercept = 0, lty = 2)+
theme(legend.justification = 'top')+
ylim(c(-2,3))+
geom_point(data = wings[wings$Index %in% c(4012,4252),], color = c('brown1','limegreen'), size = 2,pch=21)
ggplot(wings.plot[!is.na(wings.plot$Region) & wings.plot$Shape.PC1 <8,], aes(x=Size.PC1,y=Shape.PC1))+
geom_jitter(aes(col = Region), size = 0.5, alpha = 0.3)+
theme_bw()+
stat_ellipse(aes(col = Region), size = 1, lty = 1, level = 0.95)+
theme(axis.text = element_text(size = 16))+
theme(axis.title = element_text(size = 16))+
theme(legend.title=element_blank(), )+
scale_color_manual(name="Region",values=c("limegreen","gold","brown1","orange","blue",'purple'))+
guides(colour = guide_legend(override.aes = list(size=2)))+
xlab('Size PC1')+
ylab("Shape PC1")+
theme(axis.title.y = element_text(size=16))+
theme(legend.text = element_text(size=16))+
geom_hline(yintercept = 0, lty = 2)+
geom_vline(xintercept = 0, lty = 2)+
theme(legend.justification = 'top')+
ylim(c(-2,3))+
geom_point(data = wings[wings$Index %in% c(4012,4252),], fill = c('brown1','limegreen'), size = 2,pch=21)
ggplot(wings.plot[!is.na(wings.plot$Region) & wings.plot$Shape.PC1 <8,], aes(x=Size.PC1,y=Shape.PC1))+
geom_jitter(aes(col = Region), size = 0.5, alpha = 0.3)+
theme_bw()+
stat_ellipse(aes(col = Region), size = 1, lty = 1, level = 0.95)+
theme(axis.text = element_text(size = 16))+
theme(axis.title = element_text(size = 16))+
theme(legend.title=element_blank(), )+
scale_color_manual(name="Region",values=c("limegreen","gold","brown1","orange","blue",'purple'))+
guides(colour = guide_legend(override.aes = list(size=2)))+
xlab('Size PC1')+
ylab("Shape PC1")+
theme(axis.title.y = element_text(size=16))+
theme(legend.text = element_text(size=16))+
geom_hline(yintercept = 0, lty = 2)+
geom_vline(xintercept = 0, lty = 2)+
theme(legend.justification = 'top')+
ylim(c(-2,3))+
geom_point(data = wings[wings$Index %in% c(4012,4252),], fill = c('brown1','limegreen'), size = 3,pch=21)
(fig3 <- ggplot(wings.plot[!is.na(wings.plot$Region) & wings.plot$Shape.PC1 <8,], aes(x=Size.PC1,y=Shape.PC1))+
geom_jitter(aes(col = Region), size = 0.5, alpha = 0.3)+
theme_bw()+
stat_ellipse(aes(col = Region), size = 1, lty = 1, level = 0.95)+
theme(axis.text = element_text(size = 16))+
theme(axis.title = element_text(size = 16))+
theme(legend.title=element_blank(), )+
scale_color_manual(name="Region",values=c("limegreen","gold","brown1","orange","blue",'purple'))+
guides(colour = guide_legend(override.aes = list(size=2)))+
xlab('Size PC1')+
ylab("Shape PC1")+
theme(axis.title.y = element_text(size=16))+
theme(legend.text = element_text(size=16))+
geom_hline(yintercept = 0, lty = 2)+
geom_vline(xintercept = 0, lty = 2)+
theme(legend.justification = 'top')+
ylim(c(-2,3))+
geom_point(data = wings[wings$Index %in% c(4012,4252),], fill = c('brown1','limegreen'), size = 3,pch=21)) #second geom_point layer is to highlight discrepancies bw N.Amer. and S.Amer. w/ corresponding pictures
pdf(file = '~Desktop/fig3.pdf', width = 8, height = 8)
pdf(file = '~/Desktop/fig3.pdf', width = 8, height = 8)
fig3
dev.off()
pdf(file = '~/Desktop/fig3.pdf', width = 8, height = 6)
fig3
dev.off()
ggplot(adults, aes(x = Mon.Pop, y = Size.PC1))+
geom_point(aes(col = Mon.Pop), position = position_jitterdodge(3.2), size = 1.7)+
geom_boxplot(outlier.alpha = 0, alpha = 0.5, size = 0.7)+
theme_classic()+
theme(axis.title.x = element_blank(), axis.text.y = element_text(size = 16))+
stat_summary(fun.data = give.n, geom = "text", vjust = 2, size = 5)+
theme(axis.ticks = element_blank(),axis.text.x = element_blank())+
theme(legend.title=element_blank() )+
scale_color_viridis_d()+
guides(colour = guide_legend(override.aes = list(size=3)))+
ylab("Size PC1")+
theme(axis.title.y = element_text(size=16))+
theme(legend.text = element_text(size=16), legend.position = 'bottom')
adults$pa <- revalue(adults$Mon.Pop, c('Eastern North America' = 'ENA', 'Western North America' = 'WNA', 'Hawaii' = 'HI', 'Guam' = 'GU', 'Australia' = 'AU', 'Puerto Rico' = 'PR'))
ggplot(adults, aes(x = pa, y = Size.PC1))+
geom_point(aes(col = pa), position = position_jitterdodge(3.2), size = 1.7)+
geom_boxplot(outlier.alpha = 0, alpha = 0.5, size = 0.7)+
theme_classic()+
theme(axis.title.x = element_blank(), axis.text.y = element_text(size = 16))+
stat_summary(fun.data = give.n, geom = "text", vjust = 2, size = 5)+
theme(axis.ticks = element_blank(), axis.text.x = element_text(angle = 60, size =16, hjust = 1))+
scale_color_manual(values = c('limegreen','limegreen','blue','blue','blue','orange'))+
ylab("Size PC1")+
theme(axis.title.y = element_text(size=16))+
theme(legend.position = 'none')+
scale_x_discrete(labels=function(x){sub("\\s", "\n", x)})
(fig5 <- ggplot(adults, aes(x = pa, y = Size.PC1))+
geom_point(aes(col = pa), position = position_jitterdodge(3.2), size = 1.7)+
geom_boxplot(outlier.alpha = 0, alpha = 0.5, size = 0.7)+
theme_classic()+
theme(axis.title.x = element_blank(), axis.text.y = element_text(size = 16))+
stat_summary(fun.data = give.n, geom = "text", vjust = 2, size = 5)+
theme(axis.ticks = element_blank(), axis.text.x = element_text(angle = 60, size =16, hjust = 1))+
scale_color_manual(values = c('limegreen','limegreen','blue','blue','blue','orange'))+
ylab("Size PC1")+
theme(axis.title.y = element_text(size=16))+
theme(legend.position = 'none')+
scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}))
pdf(file = '~/Desktop/Second submission/figures/fig5.pdf', width = 8, height = 8)
pdf(file = '~/Desktop/fig5.pdf', width = 8, height = 8)
fig5
dev.off()
pdf(file = '~/Desktop/fig5.pdf', width = 6, height = 6.5)
fig5
dev.off()
thetas <- read.csv('~/Documents/grad_school/Manuscripts/Global wing morphology/RAFM/RAFM_1000SNPs_10000_theta.csv') ### use the pre-generated values here
comat <- matrix(NA, 5, 5)
for(i in 1:5){
for(j in 1:5){
comat[i,j] <- summary(thetas[i,j,])[3]
}
}
comat[lower.tri(comat)] <- NA
comat <- as.data.frame(comat)
colnames(comat) <- 1:5
comat$pop <- c('Eastern\nNorth\nAmerica','Guam','Hawaii','Queensland','Western\nNorth\nAmerica')
mcomat <- melt(comat, id.vars = "pop")
mcomat$variable <- revalue(as.character(mcomat$variable), c('1' = "Eastern\nNorth\nAmerica", '2' = 'Guam', '3' = 'Hawaii', '4' = 'Queensland', '5' = 'Western\nNorth\nAmerica'))
library(snpR); library(ggplot2); library(reshape2)
comat <- matrix(NA, 5, 5)
for(i in 1:5){
for(j in 1:5){
comat[i,j] <- summary(thetas[i,j,])[3]
}
}
comat[lower.tri(comat)] <- NA
comat <- as.data.frame(comat)
colnames(comat) <- 1:5
comat$pop <- c('Eastern\nNorth\nAmerica','Guam','Hawaii','Queensland','Western\nNorth\nAmerica')
mcomat <- melt(comat, id.vars = "pop")
mcomat$variable <- revalue(as.character(mcomat$variable), c('1' = "Eastern\nNorth\nAmerica", '2' = 'Guam', '3' = 'Hawaii', '4' = 'Queensland', '5' = 'Western\nNorth\nAmerica'))
ggplot(mcomat, aes(pop, variable, fill = value)) +
geom_tile(color = 'black') +
theme_minimal() +
scale_fill_gradient2(low = "white", high = "red", na.value = 'powderblue') + geom_text(aes(label = round(value, 3)))+
theme(aspect.ratio = 1)+
theme(axis.text = element_text(size = 12), axis.title = element_blank())+
theme(legend.position = 'none')
