darp
#####
#Within each milkweed species, test for whether leaf and wing cardenolide composition is different
darp <- cardenolides[-which(rowSums(cardenolides[,10:79]) == 0),]
adonis2(cards.dist.mat ~ Tissue, data = darp, permutations = 1000)
#####
#Within each milkweed species, test for whether leaf and wing cardenolide composition is different
darp <- cardenolides[-which(rowSums(cardenolides[,10:79]) == 0),]
larp <- darp[darp$Species=='GOPH',]
cards.dist.mat <- vegdist(larp[,10:79], method = 'bray')
adonis2(cards.dist.mat ~ Tissue, data = larp, permutations = 1000)
#####
#Within each milkweed species, test for whether leaf and wing cardenolide composition is different
darp <- cardenolides[-which(rowSums(cardenolides[,10:79]) == 0),]
larp <- darp[darp$Species=='ASCU',]
cards.dist.mat <- vegdist(larp[,10:79], method = 'bray')
adonis2(cards.dist.mat ~ Tissue, data = larp, permutations = 1000)
larp <- darp[darp$Species=='AINC',]
cards.dist.mat <- vegdist(larp[,10:79], method = 'bray')
adonis2(cards.dist.mat ~ Tissue, data = larp, permutations = 1000)
summary(adonis2(cards.dist.mat ~ Tissue, data = larp, permutations = 1000))
larp <- darp[darp$Species=='ASFA',]
cards.dist.mat <- vegdist(larp[,10:79], method = 'bray')
adonis2(cards.dist.mat ~ Tissue, data = larp, permutations = 1000)
larp <- darp[darp$Species=='ASYR',]
cards.dist.mat <- vegdist(larp[,10:79], method = 'bray')
adonis2(cards.dist.mat ~ Tissue, data = larp, permutations = 1000)
larp <- darp[darp$Species=='ASPEC',]
cards.dist.mat <- vegdist(larp[,10:79], method = 'bray')
adonis2(cards.dist.mat ~ Tissue, data = larp, permutations = 1000)
adult.info <- read.csv('./data/adult_data.csv')
head(adult.info)
names(adult.info)[1] <- 'Sample'
wing.cardenolides <- merge(adult.info[,names(adult.info) %in% c('Sample','Usage','Plant.ID','Pop','GH','Group','Mon.Pop','maternal_family','sym.allo','Sex')], cardenolides[cardenolides$Tissue == 'Wing',], by = 'Sample')
table(wing.cardenolides$maternal_family) #440 total samples from 73 maternal families
names(wing.cardenolides) #Description of columns:
#pdf('./figures/Fig4xa.pdf', height = 6, width = 5)
ggplot(wing.cardenolides[!wing.cardenolides$Species %in% c('ASFA','AINC'),],
aes(x = Mon.Pop, y = concentration))+
geom_boxplot(aes(fill = Species), outlier.color = 'white', alpha = 0.3)+
geom_point(aes(fill = Species), position = position_jitter(0.25), pch =21)+
facet_wrap(~Species, scales = 'free')+
scale_fill_manual(values = ascl.colors[c(1,2,5,6)])+
theme_light(base_size = 16)+
xlab('Monarch Population')+
ylab('Wing Cardenolide Concentration (mg/g)')+
theme(legend.position = 'none')+
theme(axis.text.x = element_text(angle = 75, hjust = 1))
local.adaptation.seq.model <- lmer(concentration ~ Mon.Pop + Species + sym.allo + Sex + (1|Pop/Plant.ID) + (1|maternal_family), data = wing.cardenolides[!wing.cardenolides$Species %in% c('ASFA','AINC'),])
summary(local.adaptation.seq.model) #intercept is based on Australian monarchs on ASCU. All species are lower than ASCU (checks out), and Puerto Rico and Guam both sequester less than Australia, according to this model. However, there is no effect of local adaptation: in fact, sequestration on sympatric host plants is actually modestly lower (this is probably due to Guam and ASCU being a sympatric combo)
sequestration.model <- lmer(concentration ~  Mon.Pop*Species + Sex + (1|Pop/Plant.ID) + (1|maternal_family) , data = wing.cardenolides[!wing.cardenolides$Species %in% c('ASFA','AINC'),])
summary(sequestration.model) #Once again ASCU and AU are the reference levels. ASCU higher than all other species. The strongest interaction term is for Puerto Rico on ASYR, which has a strongly negative estimate. Males sequester modestly less than females (I think this is a general pattern that has been reported before).
plot_model(sequestration.model)
ranef(sequestration.model)[[2]]
hist(ranef(sequestration.model)[[2]][[1]], breaks = 10) #distribution of random intercepts for maternal families
Anova(sequestration.model, type = 3)
Anova(local.adaptation.seq.model, type = 3)
Anova(sequestration.model, type = 3) #does indeed indicate a highly significant monarch population x species effect, although that by itself is not indicative of local adaptation
emmeans(sequestration.model, specs = ~Mon.Pop*Species, data = wing.cardenolides[!wing.cardenolides$Species %in% c('ASFA','AINC'),]) #estimated marginal means for each species x monarch population combination
summary(glht(sequestration.model, linfct = mcp(Mon.Pop = "Tukey"))) #gives a warning message related to interaction term. As an alternative, can create a new data column that corresponds to the combination of mon.pop x species, and then use this as a predictor.
wing.cardenolides$combination <- paste(wing.cardenolides$Mon.Pop, wing.cardenolides$Species, sep = ' x ')
sequestration.model.combo <- lmer(concentration ~ combination + Mon.Pop + Sex + (1|Pop/Plant.ID) + (1|maternal_family), data = wing.cardenolides[!wing.cardenolides$Species %in% c('ASFA','AINC'),])
summary(glht(sequestration.model.combo, linfct = mcp(Mon.Pop = "Tukey"))) #Can't get estimates because model includes too many levels for the combination term (n = 36) for the model to be fully specified.
emm.mon.pop <- as.data.frame(emmeans(sequestration.model, specs = ~Mon.Pop, data = wing.cardenolides[!wing.cardenolides$Species %in% c('ASFA','AINC'),])) #marginal means for monarch population only
emm.mon.pop
ggplot(emm.mon.pop, aes(x = Mon.Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.3)
ggplot(emm.mon.pop, aes(x = Mon.Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.3)+
theme_light(base_size = 16)+
ylab('Estimated Marginal Mean - Cardenolide Concentration (mg/g)')+
xlab('Monarch Population')
ggplot(emm.mon.pop, aes(x = Mon.Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.3)+
theme_light(base_size = 16)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')
ggplot(emm.mon.pop, aes(x = Mon.Pop, y = emmean))+
geom_point(size = 2)+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.4)+
theme_light(base_size = 16)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')
ggplot(emm.mon.pop, aes(x = Mon.Pop, y = emmean))+
geom_point(size = 3)+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.4)+
theme_light(base_size = 16)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')
pdf('./figures/FigS4.pdf', height = 6, width = 6)
ggplot(emm.mon.pop, aes(x = Mon.Pop, y = emmean))+
geom_point(size = 3)+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.4)+
theme_light(base_size = 16)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')
dev.off()
ggplot(emm.mon.pop, aes(x = Mon.Pop, y = emmean))+
geom_point(size = 3)+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.4, size = 2)+
theme_light(base_size = 16)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')
ggplot(emm.mon.pop, aes(x = Mon.Pop, y = emmean))+
geom_point(size = 3)+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.4, size = 1)+
theme_light(base_size = 16)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')
emm.mon.pop
pdf('./figures/FigS4.pdf', height = 6, width = 6)
ggplot(emm.mon.pop, aes(x = Mon.Pop, y = emmean))+
geom_point(size = 3)+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.4, size = 1)+
theme_light(base_size = 16)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')
dev.off()
Anova(sequestration.model, type = 3) #does indeed indicate a highly significant monarch population x species effect, although that by itself is not indicative of local adaptation
emmeans(sequestration.model, specs = ~Mon.Pop*Species, data = wing.cardenolides[!wing.cardenolides$Species %in% c('ASFA','AINC'),]) #estimated marginal means for each species x monarch population combination
summary(glht(sequestration.model, linfct = mcp(Mon.Pop = "Tukey"))) #gives a warning message related to interaction term. As an alternative, can create a new data column that corresponds to the combination of mon.pop x species, and then use this as a predictor.
wing.cardenolides$combination <- paste(wing.cardenolides$Mon.Pop, wing.cardenolides$Species, sep = ' x ')
sequestration.model.combo <- lmer(concentration ~ combination + Mon.Pop + Sex + (1|Pop/Plant.ID) + (1|maternal_family), data = wing.cardenolides[!wing.cardenolides$Species %in% c('ASFA','AINC'),])
summary(glht(sequestration.model.combo, linfct = mcp(Mon.Pop = "Tukey"))) #Can't get estimates because model includes too many levels for the combination term (n = 36) for the model to be fully specified.
emm.mon.pop <- as.data.frame(emmeans(sequestration.model, specs = ~Mon.Pop, data = wing.cardenolides[!wing.cardenolides$Species %in% c('ASFA','AINC'),])) #marginal means for monarch population only
emm.mon.pop
#pdf('./figures/FigS4.pdf', height = 6, width = 6)
ggplot(emm.mon.pop, aes(x = Mon.Pop, y = emmean))+
geom_point(size = 3)+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.4, size = 1)+
theme_light(base_size = 16)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')
rxn.norm.plot <- function(df1, pops, spp){
df.use <- df1[df1$Species %in% spp & df1$Mon.Pop %in% pops,]
agg.data <- do.call(data.frame, aggregate(concentration ~ Mon.Pop + Species, df.use,
function(y) c(mean(y), sd(y) / sqrt(length(y)))))
names(agg.data)[3:4] <- c('concentration', 'SE')
ggplot(agg.data, aes(x = Species, y = concentration, group = Mon.Pop, fill = Mon.Pop))+
geom_errorbar(aes(ymin = concentration - SE, ymax = concentration + SE, col = Mon.Pop),
width = 0.1, size = 1)+
geom_point(size = 3, pch = 21)+
geom_line(size = 1)+
theme_light(base_size = 16)+
scale_fill_manual(values = c('darkgreen','orange'))+
scale_color_manual(values = c('darkgreen','orange'))+
ylab('Wing Cardenolide Concentration (mg/g)')+
theme(legend.position = c(0.8, 0.9), legend.title = element_blank(),
legend.background = element_rect(fill = 'grey95', colour = 'black'))
}
(rxn.norm1 <- rxn.norm.plot(wing.cardenolides, pops = c('ENA','PR'), spp = c('ASYR','ASCU')))
family_averages <- aggregate(concentration ~ maternal_family + Mon.Pop + Species, wing.cardenolides[wing.cardenolides$Mon.Pop %in% c('ENA','PR') & wing.cardenolides$Species %in% c('ASYR','ASCU'),], mean)
#pdf('./figures/Figx4.pdf', height = 6, width = 4)
rxn.norm1 +
geom_point(data = family_averages, aes(col = Mon.Pop), alpha = 0.2)+
scale_color_manual(values = c('darkgreen','orange'))+
geom_line(data = family_averages, aes(group = maternal_family, col = Mon.Pop), alpha = 0.3)
head(wing.cardenolides)
d2 <- merge(wing.cardenolides[,1:9], cardenolides.polarity, by = 'Sample')
d2$pri <- ifelse(d2$Mon.Pop=='PR', 'Puerto\nRico', 'Other\nPopulations')
aggregate(polarity ~ pri + Species, data = d2[d2$Tissue=='Wing',], mean)
aggregate(polarity ~ pri + Species, data = d2[d2$Tissue=='Wing',], sd)
polarity.model <- lmer(polarity ~ pri + Species + (1|maternal_family), data = d2[d2$Species %in% c('ASYR','ASPEC'),])
summary(polarity.model)
plot.polarity <- data.frame(emmeans(polarity.model, "pri", "Species"))
#pdf('./figures/Figx4b.pdf', height = 6, width = 4)
ggplot(plot.polarity, aes(x = pri, y = emmean))+
geom_point(size = 3)+
geom_errorbar(aes(ymax = upper.CL, ymin = lower.CL), width = 0.3, size= 0.7)+
facet_wrap(~Species)+
theme_light()+
ylab('Polarity Index')+
theme(axis.title.x = element_blank(), axis.text = element_text(size = 14),
axis.title.y = element_text(size = 16), axis.text.x = element_text(angle = 60, hjust = 1))+
theme(strip.text = element_text(size = 16))
df1 <- aggregate(concentration ~   Species + Mon.Pop + maternal_family, mean, data = wing.cardenolides[wing.cardenolides$Species =='ASCU',])
names(df1)[4] <- 'ASCU_conc'
df2 <- aggregate(concentration ~  Species + Mon.Pop + maternal_family, mean, data = wing.cardenolides[wing.cardenolides$Species =='GOPH',])
names(df2)[4] <- 'GOPH_conc'
plot.card.cor <- merge(df1[,c(3,4)], df2, by = 'maternal_family')
ggplot(plot.card.cor, aes(x = ASCU_conc, y = GOPH_conc))+
geom_point(aes(col = Mon.Pop))
df3 <- aggregate(concentration ~ Species + Mon.Pop + maternal_family, mean, data = wing.cardenolides[wing.cardenolides$Species%in%c('ASCU','GOPH'),])
ggplot(df3, aes(x = Species, y = concentration, col = Mon.Pop))+
geom_point()+
geom_line(aes(group = maternal_family))+
scale_color_manual(values = c('cyan','limegreen','forestgreen','purple','blue','orange'))+
facet_wrap(~Mon.Pop)+
theme_light()
#pdf('../figures/fig5d.pdf',height = 7, width = 3)
ggplot(ASCU, aes(x = guam, y = adjusted_values, col = guam))+
geom_boxplot(outlier.color = 'white', aes(fill = guam), alpha = 0.1)+
geom_point(position = position_jitterdodge(0.25))+
theme_light(base_size = 16)+
theme(axis.title.x = element_blank(), legend.position = 'none')+
ylab('Adjusted Cardenolide Concentration')+
scale_color_manual(values = c('mediumorchid','orange'))+
scale_fill_manual(values = c('mediumorchid','orange'))+
ggtitle('Reared Monarchs -\nHost Plant Adjusted')+
theme(plot.title = element_text(hjust = 0.5))
ascu.comp.aves <- colMeans(wing.cardenolides[wing.cardenolides$Species=='ASCU',19:88])
ascu.comp.guam.aves <- colMeans(wing.cardenolides[wing.cardenolides$Species=='ASCU' & wing.cardenolides$Mon.Pop=='GU',19:88])
sort(ascu.comp.aves, decreasing = TRUE)
sort(ascu.comp.guam.aves, decreasing = TRUE)
adult.info$Date <- as.Date(adult.info$Date, "%m/%d/%Y")
adult.info$development_time <- as.numeric(difftime(as.Date(adult.info$Eclosion, "%m/%d/%Y"),adult.info$Date, units = 'days') + 8)
df2 <- merge(adult.info[,c(1,20,31)], wing.cardenolides, by = 'Sample')
pdf('./Figures/figS3.pdf',height = 8, width = 8)
ggplot(na.omit(df2[df2$development_time > 15 & df2$development_time < 30,]),
aes(x = development_time, y = concentration))+
geom_point()+
facet_wrap(~Species, scales = 'free_y')+
stat_smooth(method = 'lm', formula = y ~ poly(x, 1), col = 'black')+
theme_light(base_size = (16))+
ylab('Cardenolide Concentration (mg/g)')+
xlab('Days to Eclosion')+
theme(legend.title = element_blank())
dev.off()
summary(lmer(concentration ~ scale(development_time) + Sex + Species + Mon.Pop + (1|Plant.ID) + (1|maternal_family), data = df2)) #don't get same pattern as Agrawal paper, where sequestration was correlated with development rate
summary(lmer(concentration ~ scale(development_time) + Sex + Mon.Pop + (1|Plant.ID) + (1|maternal_family), data = df2[df2$Species=='ASFA',])) #don't get same pattern as Agrawal paper, where sequestration was correlated with development rate
table(wing.cardenolides$Species, wing.cardenolides$maternal_family)
#pdf('./figures/Fig4xa.pdf', height = 6, width = 5)
ggplot(wing.cardenolides[!wing.cardenolides$Species %in% c('ASFA','AINC'),],
aes(x = Mon.Pop, y = concentration))+
geom_boxplot(aes(fill = Species), outlier.color = 'white', alpha = 0.3)+
geom_point(aes(fill = Species), position = position_jitter(0.25), pch =21)+
facet_wrap(~Species, scales = 'free')+
scale_fill_manual(values = ascl.colors[c(1,2,5,6)])+
theme_light(base_size = 16)+
xlab('Monarch Population')+
ylab('Wing Cardenolide Concentration (mg/g)')+
theme(legend.position = 'none')+
theme(axis.text.x = element_text(angle = 75, hjust = 1))
randoms<-ranef(sequestration.model, condVar = TRUE)
gg <- attr(ranef(sequestration.model, condVar = TRUE)[[2]], "postVar")
df<-data.frame(Intercepts=randoms$maternal_family[,1],
sd.interc=2*sqrt(gg[,,1:length(gg)]),
lev.names=rownames(rand.interc))
df$lev.names<-factor(df$lev.names,levels=df$lev.names[order(df$Intercepts)])
#pdf('./figures/FigS2.pdf', height = 12, width = 8)
ggplot(df,aes(lev.names,Intercepts))+
geom_hline(yintercept=0) +geom_errorbar(aes(ymin=Intercepts-sd.interc,
ymax=Intercepts+sd.interc), width=0,color="black") + geom_point(size = 1)+
theme_bw() + xlab("Levels") + ylab("")+
theme(axis.text.x=element_text(size=rel(1.2)),
axis.title.x=element_text(size = 12),
axis.text.y=element_text(size=rel(1.2)),
panel.grid.minor=element_blank())+
coord_flip()+
ylab('Random Intercept')
Anova(sequestration.model, type = 3) #does indeed indicate a highly significant monarch population x species effect, although that by itself is not indicative of local adaptation
emmeans(sequestration.model, specs = ~Mon.Pop*Species, data = wing.cardenolides[!wing.cardenolides$Species %in% c('ASFA','AINC'),]) #estimated marginal means for each species x monarch population combination
emmeans(sequestration.model, specs = ~Mon.Pop*Species, data = wing.cardenolides[wing.cardenolides$Species == 'ASCU',) #estimated marginal means for each species x monarch population combination
emmeans(sequestration.model, specs = ~Mon.Pop*Species, data = wing.cardenolides[wing.cardenolides$Species == 'ASCU',]) #estimated marginal means for each species x monarch population combination
emmeans(sequestration.model, specs = ~Mon.Pop*Species, data = wing.cardenolides[!wing.cardenolides$Species %in% c('ASFA','AINC'),]) #estimated marginal means for each species x monarch population combination
emm.combos <- emmeans(sequestration.model, specs = ~Mon.Pop*Species, data = wing.cardenolides[!wing.cardenolides$Species %in% c('ASFA','AINC'),]) #estimated marginal means for each species x monarch population combination
emm.combos[[1]]
emm.combos[1]
emm.combos[emm.combos$Species=='ASCU',]
emm.combos <- data.frame(emmeans(sequestration.model, specs = ~Mon.Pop*Species, data = wing.cardenolides[!wing.cardenolides$Species %in% c('ASFA','AINC'),])) #estimated marginal means for each species x monarch population combination
emm
emm.combos <- as.data.frame(emmeans(sequestration.model, specs = ~Mon.Pop*Species, data = wing.cardenolides[!wing.cardenolides$Species %in% c('ASFA','AINC'),])) #estimated marginal means for each species x monarch population combination
emm.combos
ggplot(emm.combos[emm.combos$Species=='ASCU',], aes(x = Mon.Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL))
ggplot(emm.combos[emm.combos$Species=='ASCU',], aes(x = Mon.Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.3, size = 3)+
theme_light(base_size = 16)
ggplot(emm.combos[emm.combos$Species=='ASCU',], aes(x = Mon.Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.3, size = 1)+
theme_light(base_size = 14)
ggplot(emm.combos[emm.combos$Species=='ASCU',], aes(x = Mon.Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.3, size = 1)+
theme_light(base_size = 14)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')+
ggtitle(label = 'ASCU', vjust = 1)
ggplot(emm.combos[emm.combos$Species=='ASCU',], aes(x = Mon.Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.3, size = 1)+
theme_light(base_size = 14)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')+
ggtitle(label = 'ASCU')+
theme(plot.title = element_text(vjust = 0.5))
ggplot(emm.combos[emm.combos$Species=='ASCU',], aes(x = Mon.Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.3, size = 1)+
theme_light(base_size = 14)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')+
ggtitle(label = 'ASCU')+
theme(plot.title = element_text(vjust = 1))
ggplot(emm.combos[emm.combos$Species=='ASCU',], aes(x = Mon.Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.3, size = 1)+
theme_light(base_size = 14)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')+
ggtitle(label = 'ASCU')+
theme(plot.title = element_text(hjust = 1))
ggplot(emm.combos[emm.combos$Species=='ASCU',], aes(x = Mon.Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.3, size = 1)+
theme_light(base_size = 14)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')+
ggtitle(label = 'ASCU')+
theme(plot.title = element_text(hjust = 0.5))
ggplot(emm.combos[emm.combos$Species=='ASCU',], aes(x = Mon.Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.3, size = 1)+
theme_light(base_size = 14)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')+
ggtitle(label = 'ASCU')+
theme(plot.title = element_text(hjust = 0.5))+
annotate("text", x = 1, y = 18, label = "A")
ggplot(emm.combos[emm.combos$Species=='ASCU',], aes(x = Mon.Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.3, size = 1)+
theme_light(base_size = 14)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')+
ggtitle(label = 'ASCU')+
theme(plot.title = element_text(hjust = 0.5))+
annotate("text", x = 1, y = 18, label = "A", size = 3)
ggplot(emm.combos[emm.combos$Species=='ASCU',], aes(x = Mon.Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.3, size = 1)+
theme_light(base_size = 14)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')+
ggtitle(label = 'ASCU')+
theme(plot.title = element_text(hjust = 0.5))+
annotate("text", x = 1, y = 18, label = "A", size = 5)
ggplot(emm.combos[emm.combos$Species=='ASCU',], aes(x = Mon.Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.3, size = 1)+
theme_light(base_size = 14)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')+
ggtitle(label = 'ASCU')+
theme(plot.title = element_text(hjust = 0.5))+
annotate("text", x = 1, y = 17, label = "A", size = 6)
ggplot(emm.combos[emm.combos$Species=='ASCU',], aes(x = Mon.Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.3, size = 1)+
theme_light(base_size = 14)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')+
ggtitle(label = 'ASCU')+
theme(plot.title = element_text(hjust = 0.5))+
annotate("text", x = 1, y = 18, label = "A", size = 6)
ggplot(emm.combos[emm.combos$Species=='ASCU',], aes(x = Mon.Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.3, size = 1)+
theme_light(base_size = 14)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')+
ggtitle(label = 'ASCU')+
theme(plot.title = element_text(hjust = 0.5))+
annotate("text", x = 1, y = 18, label = "A", size = 6)+
annotate("text", x = 2, y = 16, label = "AB", size = 6)+
annotate("text", x = 3, y = 16, label = "A", size = 6)+
annotate("text", x = 4, y = 11.5, label = "B", size = 6)+
annotate("text", x = 5, y = 14, label = "AB", size = 6)+
annotate("text", x = 6, y = 18, label = "A", size = 6)
ggplot(emm.combos[emm.combos$Species=='ASCU',], aes(x = Mon.Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.3, size = 1)+
theme_light(base_size = 14)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')+
ggtitle(label = 'ASCU', fontface = 'italic')+
theme(plot.title = element_text(hjust = 0.5))+
annotate("text", x = 1, y = 18, label = "A", size = 6)+
annotate("text", x = 2, y = 16, label = "AB", size = 6)+
annotate("text", x = 3, y = 16, label = "A", size = 6)+
annotate("text", x = 4, y = 11.5, label = "B", size = 6)+
annotate("text", x = 5, y = 14, label = "AB", size = 6)+
annotate("text", x = 6, y = 18, label = "A", size = 6)
ggplot(emm.combos[emm.combos$Species=='ASCU',], aes(x = Mon.Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.3, size = 1)+
theme_light(base_size = 14)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')+
ggtitle(label = 'ASCU', element_text(fontface = 'italic'))+
theme(plot.title = element_text(hjust = 0.5))+
annotate("text", x = 1, y = 18, label = "A", size = 6)+
annotate("text", x = 2, y = 16, label = "AB", size = 6)+
annotate("text", x = 3, y = 16, label = "A", size = 6)+
annotate("text", x = 4, y = 11.5, label = "B", size = 6)+
annotate("text", x = 5, y = 14, label = "AB", size = 6)+
annotate("text", x = 6, y = 18, label = "A", size = 6)
ggplot(emm.combos[emm.combos$Species=='ASCU',], aes(x = Mon.Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.3, size = 1)+
theme_light(base_size = 14)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')+
ggtitle(label = 'ASCU', element_text(face = 'italic'))+
theme(plot.title = element_text(hjust = 0.5))+
annotate("text", x = 1, y = 18, label = "A", size = 6)+
annotate("text", x = 2, y = 16, label = "AB", size = 6)+
annotate("text", x = 3, y = 16, label = "A", size = 6)+
annotate("text", x = 4, y = 11.5, label = "B", size = 6)+
annotate("text", x = 5, y = 14, label = "AB", size = 6)+
annotate("text", x = 6, y = 18, label = "A", size = 6)
ggplot(emm.combos[emm.combos$Species=='ASCU',], aes(x = Mon.Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.3, size = 1)+
theme_light(base_size = 14)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')+
ggtitle(element_text(face = 'italic'), label = 'ASCU')+
theme(plot.title = element_text(hjust = 0.5))+
annotate("text", x = 1, y = 18, label = "A", size = 6)+
annotate("text", x = 2, y = 16, label = "AB", size = 6)+
annotate("text", x = 3, y = 16, label = "A", size = 6)+
annotate("text", x = 4, y = 11.5, label = "B", size = 6)+
annotate("text", x = 5, y = 14, label = "AB", size = 6)+
annotate("text", x = 6, y = 18, label = "A", size = 6)
ggplot(emm.combos[emm.combos$Species=='ASCU',], aes(x = Mon.Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.3, size = 1)+
theme_light(base_size = 14)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')+
ggtitle(label = 'ASCU')+
theme(plot.title = element_text(hjust = 0.5, face = 'italic'))+
annotate("text", x = 1, y = 18, label = "A", size = 6)+
annotate("text", x = 2, y = 16, label = "AB", size = 6)+
annotate("text", x = 3, y = 16, label = "A", size = 6)+
annotate("text", x = 4, y = 11.5, label = "B", size = 6)+
annotate("text", x = 5, y = 14, label = "AB", size = 6)+
annotate("text", x = 6, y = 18, label = "A", size = 6)
ggplot(emm.combos[emm.combos$Species=='ASCU',], aes(x = Mon.Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.3, size = 1)+
theme_light(base_size = 14)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')+
ggtitle(label = 'Sequestration from ASCU')+
theme(plot.title = element_text(hjust = 0.5, face = 'italic'))+
annotate("text", x = 1, y = 18, label = "A", size = 6)+
annotate("text", x = 2, y = 16, label = "AB", size = 6)+
annotate("text", x = 3, y = 16, label = "A", size = 6)+
annotate("text", x = 4, y = 11.5, label = "B", size = 6)+
annotate("text", x = 5, y = 14, label = "AB", size = 6)+
annotate("text", x = 6, y = 18, label = "A", size = 6)
pdf('./figures/FigS5.pdf', height = 6.5, width = 6.5)
#pdf('./figures/FigS5.pdf', height = 6.5, width = 6.5)
ggplot(emm.combos[emm.combos$Species=='ASCU',], aes(x = Mon.Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.3, size = 1)+
theme_light(base_size = 14)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')+
ggtitle(label = 'Sequestration from ASCU')+
theme(plot.title = element_text(hjust = 0.5, face = 'italic'))+
annotate("text", x = 1, y = 18, label = "A", size = 6)+
annotate("text", x = 2, y = 16, label = "AB", size = 6)+
annotate("text", x = 3, y = 16, label = "A", size = 6)+
annotate("text", x = 4, y = 11.5, label = "B", size = 6)+
annotate("text", x = 5, y = 14, label = "AB", size = 6)+
annotate("text", x = 6, y = 18, label = "A", size = 6)
dev.off()
#pdf('./figures/FigS5.pdf', height = 6.5, width = 6.5)
ggplot(emm.combos[emm.combos$Species=='ASCU',], aes(x = Mon.Pop, y = emmean))+
geom_point(size = 3)+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.3, size = 1)+
theme_light(base_size = 14)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')+
ggtitle(label = 'Sequestration from ASCU')+
theme(plot.title = element_text(hjust = 0.5, face = 'italic'))+
annotate("text", x = 1, y = 18, label = "A", size = 6)+
annotate("text", x = 2, y = 16, label = "AB", size = 6)+
annotate("text", x = 3, y = 16, label = "A", size = 6)+
annotate("text", x = 4, y = 11.5, label = "B", size = 6)+
annotate("text", x = 5, y = 14, label = "AB", size = 6)+
annotate("text", x = 6, y = 18, label = "A", size = 6)
pdf('./figures/FigS5.pdf', height = 6.5, width = 6.5)
#pdf('./figures/FigS5.pdf', height = 6.5, width = 6.5)
ggplot(emm.combos[emm.combos$Species=='ASCU',], aes(x = Mon.Pop, y = emmean))+
geom_point(size = 3)+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.3, size = 1)+
theme_light(base_size = 14)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')+
ggtitle(label = 'Sequestration from ASCU')+
theme(plot.title = element_text(hjust = 0.5, face = 'italic'))+
annotate("text", x = 1, y = 18, label = "A", size = 6)+
annotate("text", x = 2, y = 16, label = "AB", size = 6)+
annotate("text", x = 3, y = 16, label = "A", size = 6)+
annotate("text", x = 4, y = 11.5, label = "B", size = 6)+
annotate("text", x = 5, y = 14, label = "AB", size = 6)+
annotate("text", x = 6, y = 18, label = "A", size = 6)
dev.off()
aggregate(concentration ~ Species, function(x) mean(x)/sd(x), data = wing.cardenolides)
aggregate(concentration ~ Species, function(x) sd(x)/mean(x), data = wing.cardenolides)
aggregate(concentration ~ Species, function(x) mean(x), data = wing.cardenolides)
aggregate(concentration ~ Species, function(x) sd(x), data = wing.cardenolides)
