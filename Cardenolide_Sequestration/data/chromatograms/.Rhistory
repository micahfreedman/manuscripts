geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.3, size = 1)+
theme_light(base_size = 20)+
ylab('Estimated Marginal Mean - \nCardenolide Concentration (mg/g)')+
xlab('Monarch Population')+
facet_wrap(~Species, nrow = 1)+
theme(legend.title = element_blank(), legend.position = 'bottom')+
theme(axis.text.x = element_text(angle = 75, hjust = 1))+
theme(strip.text = element_text(size = 20, face = 'italic'))
summary(glht(sequestration.model, linfct = mcp(Mon.Pop = "Tukey"))) #Explicitly test for population-level differences in sequestration. Gives a warning message related to interaction term. As an alternative, can create a new data column that corresponds to the combination of mon.pop x species, and then use this as a predictor.
summary(glht(sequestration.model, linfct = mcp(Mon.Pop = "bonferronni"))) #Explicitly test for population-level differences in sequestration. Gives a warning message related to interaction term. As an alternative, can create a new data column that corresponds to the combination of mon.pop x species, and then use this as a predictor.
summary(glht(sequestration.model, linfct = mcp(Mon.Pop = "bonferroni"))) #Explicitly test for population-level differences in sequestration. Gives a warning message related to interaction term. As an alternative, can create a new data column that corresponds to the combination of mon.pop x species, and then use this as a predictor.
summary(glht(sequestration.model.combo, linfct = mcp(Mon.Pop = "Tukey"))) #Can't get estimates because model includes too many levels for the combination term (n = 36) for the model to be fully specified.
emm.mon.pop <- as.data.frame(emmeans(sequestration.model, specs = ~Mon.Pop, data = wing.cardenolides[!wing.cardenolides$Species %in% c('A. fascicularis','A. incarnata'),])) #marginal means for monarch population only
emm.mon.pop
emm.populations
emm.populations
rxn.norm.plot <- function(df1, pops, spp){
df.use <- df1[df1$Species %in% spp & df1$Mon.Pop %in% pops,]
agg.data <- do.call(data.frame, aggregate(concentration ~ Mon.Pop + Species, df.use,
function(y) c(mean(y), sd(y) / sqrt(length(y)))))
names(agg.data)[3:4] <- c('concentration', 'SE')
ggplot(agg.data, aes(x = Species, y = concentration, group = Mon.Pop, fill = Mon.Pop))+
geom_errorbar(aes(ymin = concentration - SE, ymax = concentration + SE, col = Mon.Pop),
width = 0.1, size = 1.5)+
geom_point(size = 5, pch = 21)+
geom_line(size = 2, aes(col = Mon.Pop))+
theme_light(base_size = 20)+
scale_fill_manual(values = c('darkgreen','orange'))+
scale_color_manual(values = c('darkgreen','orange'))+
ylab('Wing Cardenolide Concentration (mg/g)')+
theme(legend.position = c(0.75, 0.9), legend.title = element_blank(),
legend.background = element_rect(fill = 'white', colour = 'black'))
}
(rxn.norm1 <- rxn.norm.plot(wing.cardenolides, pops = c('E. N. America','Puerto Rico'), spp = c('A. syriaca','A. curassavica')))
family_averages <- aggregate(concentration ~ maternal_family + Mon.Pop + Species, wing.cardenolides[wing.cardenolides$Mon.Pop %in% c('E. N. America','Puerto Rico') & wing.cardenolides$Species %in% c('A. syriaca','A. curassavica'),], mean)
pdf('./figures/Fig4C.pdf', height = 8, width = 6)
rxn.norm1 +
geom_point(data = family_averages, aes(col = Mon.Pop), alpha = 0.2, size = 3)+
scale_color_manual(values = c('darkgreen','orange'))+
geom_line(data = family_averages, aes(group = maternal_family, col = Mon.Pop), alpha = 0.3, size = 1)+
theme(axis.text.x = element_text(face = 'italic'))
dev.off()
#pdf('./figures/Fig4C.pdf', height = 8, width = 6)
rxn.norm1 +
geom_point(data = family_averages, aes(col = Mon.Pop), alpha = 0.2, size = 3)+
scale_color_manual(values = c('darkgreen','orange'))+
geom_line(data = family_averages, aes(group = maternal_family, col = Mon.Pop), alpha = 0.3, size = 1)+
theme(axis.text.x = element_text(face = 'italic'))
rxn.norm.model <- lmer(concentration ~ Species*Mon.Pop + Sex + (1|maternal_family) + (1|Pop/Plant.ID), data = wing.cardenolides[wing.cardenolides$Species %in% c('A. syriaca','A. curassavica') & wing.cardenolides$Mon.Pop %in% c('Puerto Rico','E. N. America'),])
summary(rxn.norm.model)
rxn.norm.model <- lmer(concentration ~ Species*Mon.Pop + Sex + (1|maternal_family) + (1|Plant.ID), data = wing.cardenolides[wing.cardenolides$Species %in% c('A. syriaca','A. curassavica') & wing.cardenolides$Mon.Pop %in% c('Puerto Rico','E. N. America'),])
summary(rxn.norm.model)
head(wing.cardenolides)
d2 <- merge(wing.cardenolides[,1:9], cardenolides.polarity, by = 'Sample')
d2$pri <- ifelse(d2$Mon.Pop=='Puerto Rico', 'Puerto\nRico', 'Other\nPopulations')
aggregate(polarity ~ pri + Species, data = d2[d2$Tissue=='Wing',], mean)
aggregate(polarity ~ pri + Species, data = d2[d2$Tissue=='Wing',], sd)
polarity.model <- lmer(polarity ~ pri + Species + (1|maternal_family), data = d2[d2$Species %in% c('A. syriaca','A. speciosa'),])
summary(polarity.model)
plot.polarity <- data.frame(emmeans(polarity.model, "pri", "Species"))
pdf('./figures/FigS2b.pdf', height = 8, width = 3)
ggplot(plot.polarity, aes(x = pri, y = emmean, col = Species))+
geom_point(size = 3)+
geom_errorbar(aes(ymax = upper.CL, ymin = lower.CL), width = 0.3, size= 0.7)+
facet_wrap(~Species)+
theme_light()+
ylab('Polarity Index - Wing Tissue')+
theme(axis.title.x = element_blank(), axis.text = element_text(size = 14),
axis.title.y = element_text(size = 16), axis.text.x = element_text(angle = 60, hjust = 1))+
theme(strip.text = element_text(size = 14), legend.position = 'none')+
scale_color_manual(values = c('dodgerblue','turquoise'))
dev.off()
#pdf('./figures/FigS2b.pdf', height = 8, width = 3)
ggplot(plot.polarity, aes(x = pri, y = emmean, col = Species))+
geom_point(size = 3)+
geom_errorbar(aes(ymax = upper.CL, ymin = lower.CL), width = 0.3, size= 0.7)+
facet_wrap(~Species)+
theme_light()+
ylab('Polarity Index - Wing Tissue')+
theme(axis.title.x = element_blank(), axis.text = element_text(size = 14),
axis.title.y = element_text(size = 16), axis.text.x = element_text(angle = 60, hjust = 1))+
theme(strip.text = element_text(size = 14), legend.position = 'none')+
scale_color_manual(values = c('dodgerblue','turquoise'))
#pdf('./figures/FigS2b.pdf', height = 8, width = 3)
ggplot(plot.polarity, aes(x = pri, y = emmean, col = Species))+
geom_point(size = 3)+
geom_errorbar(aes(ymax = upper.CL, ymin = lower.CL), width = 0.3, size= 0.7)+
facet_wrap(~Species)+
theme_light()+
ylab('Polarity Index - Wing Tissue')+
theme(axis.title.x = element_blank(), axis.text = element_text(size = 14),
axis.title.y = element_text(size = 16), axis.text.x = element_text(angle = 60, hjust = 1))+
theme(strip.text = element_text(size = 14), legend.position = 'none')+
scale_color_manual(values = c('dodgerblue','turquoise'))
df3 <- aggregate(concentration ~   Species + Mon.Pop + maternal_family, mean, data = wing.cardenolides[wing.cardenolides$Species =='A. curassavica',])
names(df3)[4] <- 'ASCU_conc'
df4 <- aggregate(concentration ~  Species + Mon.Pop + maternal_family, mean, data = wing.cardenolides[wing.cardenolides$Species =='G. physocarpus',])
names(df4)[4] <- 'GOPH_conc'
plot.card.cor <- merge(df3[,c(3,4)], df4, by = 'maternal_family')
ggplot(plot.card.cor, aes(x = ASCU_conc, y = GOPH_conc))+
geom_point(aes(col = Mon.Pop))
df5 <- aggregate(concentration ~ Species + Mon.Pop + maternal_family, mean, data = wing.cardenolides[wing.cardenolides$Species%in%c('A. curassavica','G. physocarpus'),])
ggplot(df5, aes(x = Species, y = concentration, col = Mon.Pop))+
geom_point()+
geom_line(aes(group = maternal_family))+
scale_color_manual(values = c('cyan','limegreen','forestgreen','purple','blue','orange'))+
facet_wrap(~Mon.Pop)+
theme_light() #does seem to be some variation across maternal families in rank order of sequestration
cardenolides[cardenolides$Species=='A. curassavica' & cardenolides$Tissue=='Leaf',]$Sample
merge(cardenolides[cardenolides$Species=='A. curassavica' & cardenolides$Tissue=='Leaf',], adult.info[adult.info$Species=='ASCU', names(adult.info) %in% c('Sample','Pop')], by = 'Sample')
adult.info[adult.info$Species=='A. curassavica',names(adult.info) %in% c('Sample','Pop')]
ascu.leaf.cards <- cardenolides[cardenolides$Species=='A. curassavica' & cardenolides$Tissue=='Leaf',]
ascu.leaf.cards$Sample
ascu.leaf.cards$Pop <- ifelse(ascu.leaf.cards$Sample %in% c('1004','1005','1014','1017','1018','1020','1024','1025','1027','1028','1030','1034','1037','1042','1059','1062','1057','172','186','195','203','216','218','224','L170','L175','L188','L190','L199','L206','L215'), 'Guam', 'Rota')
guam.rota.ascu <- lm(concentration ~ Pop, data = ascu.leaf.cards) #not significantly higher, but def in the same direction as field samples
summary(guam.rota.ascu)
emmeans(guam.rota.ascu, specs = 'Pop')
ggplot(ascu.leaf.cards, aes(x = Pop, y = concentration))+
geom_boxplot()
spp.leaf.means <- aggregate(concentration ~ Species, mean, data = cardenolides[cardenolides$Tissue=='Leaf',])
spp.leaf.means <- aggregate(concentration ~ Species, mean, data = cardenolides[cardenolides$Tissue=='Leaf',])
ASCU <- wing.cardenolides[wing.cardenolides$Species=='A. curassavica',]
ASCU$adjusted_values <- ASCU$concentration / spp.leaf.means[spp.leaf.means$Species=='A. curassavica',][[2]]
ASCU$guam <- ifelse(ASCU$Mon.Pop=='GU', 'Guam', 'Others')
aggregate(adjusted_values ~ guam, mean, data = ASCU)
#pdf('./figures/Figure5D.pdf',height = 7, width = 3)
ggplot(ASCU, aes(x = guam, y = adjusted_values, col = guam))+
geom_boxplot(outlier.color = 'white', aes(fill = guam), alpha = 0.1)+
geom_point(position = position_jitterdodge(0.25))+
theme_light(base_size = 16)+
theme(axis.title.x = element_blank(), legend.position = 'none')+
ylab('Adjusted Cardenolide Concentration')+
scale_color_manual(values = c('mediumorchid','orange'))+
scale_fill_manual(values = c('mediumorchid','orange'))+
ggtitle('Reared Monarchs -\nHost Plant Adjusted')+
theme(plot.title = element_text(hjust = 0.5))
pdf('./figures/Figure5D_old.pdf',height = 7, width = 3)
ggplot(ASCU, aes(x = guam, y = adjusted_values, col = guam))+
geom_boxplot(outlier.color = 'white', aes(fill = guam), alpha = 0.1)+
geom_point(position = position_jitterdodge(0.25))+
theme_light(base_size = 16)+
theme(axis.title.x = element_blank(), legend.position = 'none')+
ylab('Adjusted Cardenolide Concentration')+
scale_color_manual(values = c('mediumorchid','orange'))+
scale_fill_manual(values = c('mediumorchid','orange'))+
ggtitle('Reared Monarchs -\nHost Plant Adjusted')+
theme(plot.title = element_text(hjust = 0.5))
dev.off()
ascu.comp.aves <- colMeans(wing.cardenolides[wing.cardenolides$Species=='A. curassavica',19:88])
sort(ascu.comp.aves, decreasing = TRUE) #shows that frugoside is most abundant compound in wings of A. curassavica reared monarchs
sum(sort(ascu.comp.aves, decreasing = TRUE)[c(1,4,5)]) / sum(ascu.comp.aves) #Frugoside, calactin, and calotropin comprise 51% of the total cardenolides sequestered from ASCU. Frugoside is the most abundant compound, with about 24% of the total amount.
goph.comp.aves <- colMeans(wing.cardenolides[wing.cardenolides$Species=='G. physocarpus',19:88])
sort(goph.comp.aves, decreasing = TRUE) #For GOPH, frugoside is also the most abundant compound. Calactin is the fourth most abundant compound, and calotropin is sixth.
sum(sort(goph.comp.aves, decreasing = TRUE)[c(1,4,6)]) / sum(goph.comp.aves) #these compounds comprise 46% of the total sequestered from Gomphocarpus
asyr.comp.aves <- colMeans(wing.cardenolides[wing.cardenolides$Species=='A. syriaca',19:88])
sort(asyr.comp.aves, decreasing = TRUE) #For ASYR, 1.06 (likely to be aspecioside, which registered at 1.12) is by far the most abundant compound.
sort(asyr.comp.aves, decreasing = TRUE)[1] / sum(asyr.comp.aves) #Aspecioside comprises 48.3% of the total amount sequestered from ASYR
aspec.comp.aves <- colMeans(wing.cardenolides[wing.cardenolides$Species=='A. speciosa',19:88])
sort(aspec.comp.aves, decreasing = TRUE)
sort(aspec.comp.aves, decreasing = TRUE)[1] / sum(aspec.comp.aves) #Aspecioside comprises 44.0% of the total amount sequestered from ASPEC
adult.info$Date <- as.Date(adult.info$Date, "%m/%d/%Y")
adult.info$development_time <- as.numeric(difftime(as.Date(adult.info$Eclosion, "%m/%d/%Y"),adult.info$Date, units = 'days') + 8)
df6 <- merge(adult.info[,c(1,20,31)], wing.cardenolides, by = 'Sample')
#pdf('./Figures/FigureS6.pdf',height = 8, width = 8)
ggplot(na.omit(df6[df6$development_time > 15 & df6$development_time < 30,]),
aes(x = development_time, y = concentration))+
geom_point()+
facet_wrap(~Species, scales = 'free_y')+
stat_smooth(method = 'lm', formula = y ~ poly(x, 1), col = 'black')+
theme_light(base_size = (16))+
ylab('Cardenolide Concentration (mg/g)')+
xlab('Days to Eclosion')+
theme(legend.title = element_blank())
pdf('./Figures/FigureS8.pdf',height = 8, width = 8)
ggplot(na.omit(df6[df6$development_time > 15 & df6$development_time < 30,]),
aes(x = development_time, y = concentration))+
geom_point()+
facet_wrap(~Species, scales = 'free_y')+
stat_smooth(method = 'lm', formula = y ~ poly(x, 1), col = 'black')+
theme_light(base_size = (16))+
ylab('Cardenolide Concentration (mg/g)')+
xlab('Days to Eclosion')+
theme(legend.title = element_blank())
dev.off()
summary(lmer(concentration ~ scale(development_time) + Sex + Species + Mon.Pop + (1|Plant.ID) + (1|maternal_family), data = df6)) #don't get same pattern as Agrawal paper, where sequestration was correlated with development rate (higher sequestration in slower developing caterpillars), at least for a model with a single slope estimate for development time
model.dev.time <- (lmer(concentration ~  Sex + (scale(development_time)|Species) + Mon.Pop + (1|Plant.ID) + (1|maternal_family), data = df6))
coef(model.dev.time) #when each species is allowed to have a varying slope for this relationship, then there is indeed a positive relationship between development time and sequestration on A. curassavica, consistent with the Agrawal et al. (2021) study. However, it is the only species for which this pattern is apparent, and it is still a relatively modest relationship (an increase of 1 SD of development time leads to a 2.6% increase in sequestered cardenolides)
df6$cards.adjusted <- df6$concentration/df6$development_time
df7 <- df6[df6$development_time > 15,] #exclude errant sample with a development time less than 15 days (probably a date/data entry error)
model.dev.time.adjusted <- lmer(cards.adjusted ~ Mon.Pop + Species + sym.allo + Sex + (1|Pop/Plant.ID) + (1|maternal_family), data = df7[!df7$Species %in% c('A. fascicularis','A. incarnata'),])
summary(model.dev.time.adjusted) #No change in inference, as suggested by the lack of a correlation between sequestration and development time shown in plots previous. Seems pretty clear that there is no overall sympatric sequestration advantage.
aggregate(cards.adjusted ~ Mon.Pop + Species, data = df6, mean)
df6$pr.vs.all <- ifelse(df6$Mon.Pop == 'PR', 'PR', 'other')
aggregate(cards.adjusted ~ pr.vs.all + Species, df6, mean)
adj.means <- aggregate(cards.adjusted ~ Mon.Pop + Species, df6[!df6$Species %in% c('A. fascicularis','A. incarnata'),], mean)
adj.sd <- aggregate(cards.adjusted ~ Mon.Pop + Species, df6[!df6$Species %in% c('A. fascicularis','A. incarnata'),], sd)
names(adj.sd)[3] <- 'SD'
plot.adj <- merge(adj.means, adj.sd)
(0.313 - 0.242) / 0.242  #29.3% higher adjusted sequestration on GOPH
(0.705 - 0.542) / 0.542 #30.0% higher adjusted sequestration of ASCU
#pdf('./figures/FigureS5a.pdf', height = 6, width = 6)
ggplot(plot.adj, aes(x = Mon.Pop, y = cards.adjusted))+
geom_point(size = 3)+
geom_errorbar(aes(ymin = cards.adjusted-SD, ymax = cards.adjusted+SD), width = 0.3, size = 1)+
theme_light(base_size = 16)+
ylab('Sequestered Cardenolides (mg/g)\nper Day of Development')+
xlab('Monarch Population')+
facet_wrap(~Species, scales = 'free')+
theme(legend.title = element_blank(), legend.position = 'bottom')+
theme(axis.text.x = element_text(angle = 75, hjust = 1))
pdf('./figures/FigureS7a.pdf', height = 6, width = 6)
ggplot(plot.adj, aes(x = Mon.Pop, y = cards.adjusted))+
geom_point(size = 3)+
geom_errorbar(aes(ymin = cards.adjusted-SD, ymax = cards.adjusted+SD), width = 0.3, size = 1)+
theme_light(base_size = 16)+
ylab('Sequestered Cardenolides (mg/g)\nper Day of Development')+
xlab('Monarch Population')+
facet_wrap(~Species, scales = 'free')+
theme(legend.title = element_blank(), legend.position = 'bottom')+
theme(axis.text.x = element_text(angle = 75, hjust = 1))
dev.off()
#pdf('./figures/FigureS7a.pdf', height = 6, width = 6)
ggplot(plot.adj, aes(x = Mon.Pop, y = cards.adjusted))+
geom_point(size = 3)+
geom_errorbar(aes(ymin = cards.adjusted-SD, ymax = cards.adjusted+SD), width = 0.3, size = 1)+
theme_light(base_size = 16)+
ylab('Sequestered Cardenolides (mg/g)\nper Day of Development')+
xlab('Monarch Population')+
facet_wrap(~Species, scales = 'free')+
theme(legend.title = element_blank(), legend.position = 'bottom')+
theme(axis.text.x = element_text(angle = 75, hjust = 1))
pdf('./figures/FigureS2.pdf', height = 8, width = 8)
pdf('./figures/FigureS3.pdf', height = 8, width = 8)
par(mfrow = c(2, 2))
ASCU <- wing.cardenolides[wing.cardenolides$Species=='A. curassavica',]
ascu.M <- cor(ASCU[,names(sort(ascu.comp.aves, decreasing = TRUE)[1:6])])
corrplot(ascu.M, method = 'circle', title = 'A. curassavica', type = "upper", col=colorRampPalette(c("blue","white","orange"))(200), outline = 'black', diag = FALSE, mar = c(0,0,2,0))
GOPH <- wing.cardenolides[wing.cardenolides$Species=='G. physocarpus',]
goph.M <- cor(GOPH[,names(sort(goph.comp.aves, decreasing = TRUE)[1:6])])
corrplot(goph.M, method = 'circle', title = 'G. physocarpus', type = "upper", col=colorRampPalette(c("blue","white","orange"))(200), outline = 'black', diag = FALSE, mar = c(0,0,2,0))
ASYR <- wing.cardenolides[wing.cardenolides$Species=='A. syriaca',]
asyr.M <- cor(ASYR[,names(sort(asyr.comp.aves, decreasing = TRUE)[1:5])])
corrplot(asyr.M, method = 'circle', title = 'A. syriaca', type = "upper", col=colorRampPalette(c("blue","white","orange"))(200), outline = 'black', diag = FALSE, mar = c(0,0,2,0))
ASPEC <- wing.cardenolides[wing.cardenolides$Species=='A. speciosa',]
aspec.M <- cor(ASPEC[,names(sort(aspec.comp.aves, decreasing = TRUE)[1:5])])
corrplot(aspec.M, method = 'circle', title = 'A. speciosa', type = "upper", col=colorRampPalette(c("blue","white","orange"))(200), outline = 'black', diag = FALSE, mar = c(0,0,2,0))
dev.off()
par(mfrow = c(1, 1))
ASCU <- wing.cardenolides[wing.cardenolides$Species=='A. curassavica',]
ascu.M <- cor(ASCU[,names(sort(ascu.comp.aves, decreasing = TRUE)[1:6])])
corrplot(ascu.M, method = 'circle', title = 'A. curassavica', type = "upper", col=colorRampPalette(c("blue","white","orange"))(200), outline = 'black', diag = FALSE, mar = c(0,0,2,0))
GOPH <- wing.cardenolides[wing.cardenolides$Species=='G. physocarpus',]
goph.M <- cor(GOPH[,names(sort(goph.comp.aves, decreasing = TRUE)[1:6])])
corrplot(goph.M, method = 'circle', title = 'G. physocarpus', type = "upper", col=colorRampPalette(c("blue","white","orange"))(200), outline = 'black', diag = FALSE, mar = c(0,0,2,0))
ASYR <- wing.cardenolides[wing.cardenolides$Species=='A. syriaca',]
asyr.M <- cor(ASYR[,names(sort(asyr.comp.aves, decreasing = TRUE)[1:5])])
corrplot(asyr.M, method = 'circle', title = 'A. syriaca', type = "upper", col=colorRampPalette(c("blue","white","orange"))(200), outline = 'black', diag = FALSE, mar = c(0,0,2,0))
ASPEC <- wing.cardenolides[wing.cardenolides$Species=='A. speciosa',]
aspec.M <- cor(ASPEC[,names(sort(aspec.comp.aves, decreasing = TRUE)[1:5])])
corrplot(aspec.M, method = 'circle', title = 'A. speciosa', type = "upper", col=colorRampPalette(c("blue","white","orange"))(200), outline = 'black', diag = FALSE, mar = c(0,0,2,0))
aggregate(concentration ~ Species, function(x) sd(x)/mean(x), data = wing.cardenolides)
ascl.nam.cards_nmds <- metaMDS(comm = wing.cardenolides[wing.cardenolides$Species == 'A. syriaca', 19:88], distance = 'bray', k = 3, trymax = 20)
nam.data.scores <- cbind(wing.cardenolides[wing.cardenolides$Species == 'A. syriaca',1:18], ascl.nam.cards_nmds$points)
ggplot(nam.data.scores, aes(x = MDS1, y = MDS2, col = Mon.Pop))+
geom_point()+
stat_ellipse(aes(col = Mon.Pop), level = 0.95)
wing.cardenolides.nmds <- wing.cardenolides[wing.cardenolides$Sample != '1003.1' & wing.cardenolides$Sample != '418.1' & wing.cardenolides$Sample != '822.1',] #first, omit three samples that have wonky NMDS scores (huge outliers that kind of make wonder whether they were either misassigned or contained only trace amounts; note that these were also omitted from earlier NMDS analyses)
ascl.cards_nmds <- metaMDS(comm = wing.cardenolides.nmds[wing.cardenolides.nmds$Species %in% c('A. syriaca','A. speciosa','G. physocarpus','A. curassavica'), 19:88], distance = 'bray', k = 5, trymax = 200) #takes about 5 minutes to run with 500 iterations and k = 10
ascl.wing.data.scores <- cbind(wing.cardenolides.nmds[wing.cardenolides.nmds$Species %in% c('A. syriaca','A. speciosa','G. physocarpus','A. curassavica'),1:18], ascl.cards_nmds$points)
ggplot(ascl.wing.data.scores, aes(x = MDS1, y = MDS2, col = Mon.Pop, fill = Mon.Pop))+
geom_point()+
facet_wrap(~Species, scales = 'free')+
stat_ellipse(aes(col = Mon.Pop), level = 0.95, geom = 'polygon', alpha = 0.05)+
theme_light(base_size = 16)+
scale_color_manual(values = c('cyan','limegreen','forestgreen','purple','blue','orange'))+
scale_fill_manual(values = c('cyan','limegreen','forestgreen','purple','blue','orange'))+
theme(legend.position = 'bottom', legend.title = element_blank())
pdf('./figures/FigureS4.pdf', height = 8, width = 8)
ggplot(ascl.wing.data.scores, aes(x = MDS1, y = MDS2, col = Mon.Pop, fill = Mon.Pop))+
geom_point()+
facet_wrap(~Species, scales = 'free')+
stat_ellipse(aes(col = Mon.Pop), level = 0.95, geom = 'polygon', alpha = 0.05)+
theme_light(base_size = 16)+
scale_color_manual(values = c('cyan','limegreen','forestgreen','purple','blue','orange'))+
scale_fill_manual(values = c('cyan','limegreen','forestgreen','purple','blue','orange'))+
theme(legend.position = 'bottom', legend.title = element_blank())
dev.off()
ascl.cards.dist.mat <- vegdist(wing.cardenolides.nmds[wing.cardenolides.nmds$Species %in% c('A. syriaca','A. speciosa','G. physocarpus','A. curassavica'),19:88], method = 'bray')
adonis2(ascl.cards.dist.mat ~ Mon.Pop*Species + Sex, data = wing.cardenolides.nmds[wing.cardenolides.nmds$Species %in% c('A. syriaca','A. speciosa','G. physocarpus','A. curassavica'),], permutations = 1000) #Table S6
adonis2(ascl.cards.dist.mat ~ Mon.Pop*Species + Sex, data = wing.cardenolides.nmds[wing.cardenolides.nmds$Species %in% c('A. syriaca','A. speciosa','G. physocarpus','A. curassavica'),], permutations = 1000) #Table S6
wing.cardenolides$sample_match <- wing.cardenolides$Plant.ID
leaf.cardenolides <- cardenolides[cardenolides$Tissue=='Leaf',]
leaf.cardenolides$sample_match <- readr::parse_number(leaf.cardenolides$Sample)
lw.cor <- merge(wing.cardenolides[,c('Mon.Pop','Sex','maternal_family','Species','concentration','sample_match')], leaf.cardenolides[,c('concentration','sample_match')], by = 'sample_match')
names(lw.cor)[6:7] <- c('wing_conc', 'leaf_conc')
lw.cor <- lw.cor[-which(lw.cor$Species=='A. syriaca' & lw.cor$leaf_conc > 3),] #drop one ASYR outlier whose leaf concentration is 10x higher than all other samples
#pdf('./figures/FigureS9.pdf', height = 6, width = 6)
ggplot(lw.cor[!lw.cor$Species %in% c('AINC','ASFA'),],
aes(x = leaf_conc, y = wing_conc))+
theme_light(base_size = 16)+
geom_point()+
facet_wrap(~Species, scales = 'free')+
stat_smooth(method = 'lm')+
xlab('Leaf Cardenolide Concentration (mg/g)')+
ylab('Wing Cardenolide Concentration (mg/g)')
pdf('./figures/FigureS5.pdf', height = 6, width = 6)
ggplot(lw.cor[!lw.cor$Species %in% c('AINC','ASFA'),],
aes(x = leaf_conc, y = wing_conc))+
theme_light(base_size = 16)+
geom_point()+
facet_wrap(~Species, scales = 'free')+
stat_smooth(method = 'lm')+
xlab('Leaf Cardenolide Concentration (mg/g)')+
ylab('Wing Cardenolide Concentration (mg/g)')
dev.off()
lw.cor.model1 <- lmer(wing_conc ~ leaf_conc + Species*Mon.Pop + Sex + (1|maternal_family) + (1|sample_match), data = lw.cor[lw.cor$Species %in% c('A. curassavica','A. syriaca','A. speciosa','G. physocarpus'),])
summary(lw.cor.model) #only get a weak positive association between leaf concentration and wing concentration
summary(lw.cor.model1) #only get a weak positive association between leaf concentration and wing concentration
lw.cor.model2 <- lmer(wing_conc ~ Species*Mon.Pop + Sex + (1|maternal_family) + (1|sample_match), data = lw.cor[lw.cor$Species %in% c('A. curassavica','A. syriaca','A. speciosa','G. physocarpus'),])
AIC(lw.cor.model1, lw.cor.model2) #model without leaf chemistry is preferred
lw.cor$ratio <- lw.cor$wing_conc / lw.cor$leaf_conc
lw.cor$ratio <- ifelse(lw.cor$ratio == "Inf", lw.cor$ratio == NA, lw.cor$ratio) #replace all "inf" values (resulting from leaf concentrations of 0) with NA
aggregate(ratio ~ Species, mean, data = lw.cor)
aggregate(ratio ~ Species, length, data = lw.cor)
aggregate(ratio ~ Species, function(x) sd(x)/sqrt(length(x)), data = lw.cor)
Concentration <- c(lw.cor$leaf_conc, lw.cor$wing_conc)
Tissue <- c(rep('Leaf', nrow(lw.cor)), rep('Wing', nrow(lw.cor)))
Species <- rep(lw.cor$Species, 2)
Sample <- rep(lw.cor$sample_match, 2)
plot_lw.cor <- data.frame(Sample, Tissue, Species, Concentration)
pdf('./figures/FigureS1.pdf', height = 6, width = 6)
ggplot(plot_lw.cor, aes(x = Tissue, y = Concentration, fill = Species))+
geom_boxplot(outlier.color = 'white', alpha = 0.1)+
geom_point(pch = 21)+
geom_line(aes(group = Sample, col = Species))+
scale_fill_manual(values = ascl.colors)+
scale_color_manual(values = ascl.colors)+
facet_wrap(~Species, ncol = 3, scales = 'free')+
theme_light(base_size = 16)+
theme(legend.position = 'none')+
ylab('Cardenolide Concentration (mg/g)')+
theme(strip.text = element_text(face = 'italic', size = 14))
dev.off()
ggplot(plot_lw.cor, aes(x = Tissue, y = Concentration, fill = Species))+
geom_boxplot(outlier.color = 'white', alpha = 0.1)+
geom_point(pch = 21)+
geom_line(aes(group = Sample, col = Species))+
scale_fill_manual(values = ascl.colors)+
scale_color_manual(values = ascl.colors)+
facet_wrap(~Species, ncol = 3, scales = 'free')+
theme_light(base_size = 16)+
theme(legend.position = 'none')+
ylab('Cardenolide Concentration (mg/g)')+
theme(strip.text = element_text(face = 'italic', size = 14))
all_chromatograms <- list() #empty list to read in data
for(i in seq_along(list.files())){
all_chromatograms[[i]] <- read.table(file = list.files()[i], skip = 44, header = F)
} #loop through directory; each file has metadata in the header that spans the first 44 lines
setwd("../Cardenolide_Sequestration/data/chromatograms/")
all_chromatograms <- list() #empty list to read in data
all_chromatograms
for(i in seq_along(list.files())){
all_chromatograms[[i]] <- read.table(file = list.files()[i], skip = 44, header = F)
} #loop through directory; each file has metadata in the header that spans the first 44 lines
names(all_chromatograms) <- sub("\\_.*", "", list.files()) #name each dataframe according to its file name (chooses all characters prior to the first underscore)
sample_id <- names(all_chromatograms)
all_chromatograms <- mapply(cbind, all_chromatograms, sample = sample_id, SIMPLIFY = F) #adds a sample ID column to each dataframe
df1 <- do.call(rbind, all_chromatograms) #converts into a single dataframe
names(df1) <- c('RT', 'Step', 'Value', 'sample') #rename columns
df1$Value <- as.numeric(ifelse(df1$Value < 0, 0, df1$Value)) #replace all signal intensity values that are negative with 0s
df1$species <- with(df1, ifelse(sample %in% c('1014.2','1020','1030.1','1039.3','1051.1'), 'ASCU',
ifelse(sample %in% c('406.2','433'), 'GOPH',
ifelse(sample %in% c('536','547.1'), 'AINC',
ifelse(sample %in% c('702','749.1'), 'ASPEC',
ifelse(sample %in% c('801.1P','805.4','807.1AU','844'), 'ASYR', 'ASFA'))))))
ggplot(df1, aes(x = RT, y = Value, col = species))+
geom_line()+
facet_wrap(~sample, scales = 'free') #quick plot to see all data. Note that the internal standard is just after 10 minutes, so anything after is not important. Also, large peak immediately at the start of each chromatogram was not a cardenolide, so this can be omitted.
ggplot(df1[df1$RT > 0.7 & df1$RT < 12 & df1$sample %in% c('1020','1051.1'),],
aes(x = RT, y = Value, col = sample))+
geom_line()+
ylab('Signal Intensity (mAU)') #example of a leaf and wing sample together; baseline is slightly higher for leaf tissue, but can see correspondence between some peaks (e.g. 2.3 mins, 5.8 mins, and the IS)
ggplot(df1[df1$RT > 0.7 & df1$RT < 15 & df1$sample %in% c('1020','1051.1'),],
aes(x = RT, y = Value, col = sample))+
geom_line()+
ylab('Signal Intensity (mAU)') #example of a leaf and wing sample together; baseline is slightly higher for leaf tissue, but can see correspondence between some peaks (e.g. 2.3 mins, 5.8 mins, and the IS)
ggplot(df1[df1$RT > 0.7 & df1$RT < 12 & df1$sample %in% c('1020','1051.1'),],
aes(x = RT, y = Value, col = sample))+
geom_line()+
ylab('Signal Intensity (mAU)') #example of a leaf and wing sample together; baseline is slightly higher for leaf tissue, but can see correspondence between some peaks (e.g. 2.3 mins, 5.8 mins, and the IS)
display.samples <- c('406.2','547.1','749.1','805.4','940.1','1051.1')
df1$species <- factor(df1$species, c('GOPH','ASCU','AINC','ASFA','ASYR','ASPEC'))
ascl.colors <- c('blue','purple','coral','gold','dodgerblue','turquoise')
df1$species <- recode_factor(df1$species, GOPH = 'G. physocarpus',ASCU = 'A. curassavica',AINC = 'A. incarnata',ASFA = 'A. fascicularis',ASYR = 'A. syriaca',ASPEC = 'A. speciosa')
pdf('../../figures/Figure2A.pdf', height = 12, width = 8)
ggplot(df1[df1$RT > 0.7 & df1$RT < 11 & df1$sample %in% display.samples,],
aes(x = RT, y = Value, col = species))+
geom_line(size = 0.5)+
geom_area(aes(fill = species), alpha = 0.3)+
theme_light(base_size = 18)+
facet_wrap(~species, ncol = 1, strip.position = 'right')+
ylab('Signal Intensity (mAU)')+
xlab('Retention Time (Minutes)')+
scale_fill_manual(values = ascl.colors)+
scale_color_manual(values = ascl.colors)+
theme(legend.position = 'none')+
theme(strip.text = element_text(face = 'italic', size = 14))+
ylim(c(0,150))
dev.off()
ggplot(df1[df1$RT > 0.7 & df1$RT < 11 & df1$sample %in% display.samples,],
aes(x = RT, y = Value, col = species))+
geom_line(size = 0.5)+
geom_area(aes(fill = species), alpha = 0.3)+
theme_light(base_size = 18)+
facet_wrap(~species, ncol = 1, strip.position = 'right')+
ylab('Signal Intensity (mAU)')+
xlab('Retention Time (Minutes)')+
scale_fill_manual(values = ascl.colors)+
scale_color_manual(values = ascl.colors)+
theme(legend.position = 'none')+
theme(strip.text = element_text(face = 'italic', size = 14))+
ylim(c(0,150))
ggplot(df1[df1$RT > 0.7 & df1$RT < 12 & df1$sample =='805.4',],
aes(x = RT, y = Value))+
geom_line(size = 0.5)+
geom_area(aes(fill = species), alpha = 0.3)+
theme_light(base_size = 18)+
ylab('Signal Intensity (mAU)')+
xlab('Retention Time (Minutes)')+
theme(legend.position = 'none')+
ylim(c(0,150))
df2 <- df1[df1$sample %in% c('807.1AU','801.1P'),]
df2$display.value <- ifelse(df2$sample=='807.1AU', df2$Value, df2$Value*-1)
df2$pop <- ifelse(df2$sample=='801.1P', "PR", "Australia")
#pdf('../../figures/FigureS4.pdf', height = 5, width = 7)
ggplot(df2[df2$RT > 0.7 & df2$RT < 12,],
aes(x = RT, y = display.value))+
geom_line(size = 0.5, aes(col = pop))+
geom_area(aes(fill = pop), alpha = 0.2)+
theme_dark(base_size = 14)+
ylab('Signal Intensity')+
xlab('Retention Time (Minutes)')+
theme(legend.position = 'bottom', legend.title = element_blank())+
ylim(c(-75,75))+
scale_fill_manual(values = c('cyan','orange'))+scale_color_manual(values = c('cyan','orange'))+
theme(axis.text.y = element_blank())+
annotate("text", x = 1.1, y = -35, label = 'aspecioside', angle = 90, color = 'white')+
annotate("text", x = 10, y = -35, label = 'digitoxin\n(value truncated)',angle = 90, color = 'white')
pdf('../../figures/FigureS5.pdf', height = 5, width = 7)
ggplot(df2[df2$RT > 0.7 & df2$RT < 12,],
aes(x = RT, y = display.value))+
geom_line(size = 0.5, aes(col = pop))+
geom_area(aes(fill = pop), alpha = 0.2)+
theme_dark(base_size = 14)+
ylab('Signal Intensity')+
xlab('Retention Time (Minutes)')+
theme(legend.position = 'bottom', legend.title = element_blank())+
ylim(c(-75,75))+
scale_fill_manual(values = c('cyan','orange'))+scale_color_manual(values = c('cyan','orange'))+
theme(axis.text.y = element_blank())+
annotate("text", x = 1.1, y = -35, label = 'aspecioside', angle = 90, color = 'white')+
annotate("text", x = 10, y = -35, label = 'digitoxin\n(value truncated)',angle = 90, color = 'white')
dev.off()
df3 <- df1[df1$sample %in% c('1051.1','1039.3'),]
df3$display.value <- ifelse(df3$sample=='1051.1', df3$Value, df3$Value*-1)
ggplot(df3[df3$RT > 0.7 & df3$RT < 12,],
aes(x = RT, y = display.value))+
geom_line(size = 0.5, aes(col = sample))+
geom_area(aes(fill = sample), alpha = 0.1)+
theme_light(base_size = 18)+
ylab('Signal Intensity')+
xlab('Retention Time (Minutes)')+
theme(legend.position = 'none')+
scale_fill_manual(values = c('orange','forestgreen'))+scale_color_manual(values = c('orange','forestgreen'))+
theme(axis.text.y = element_blank())+
ylim(c(-150,150))
ggplot(df3[df3$RT > 0.7 & df3$RT < 12,],
aes(x = RT, y = display.value))+
geom_line(size = 0.5, aes(col = sample))+
geom_area(aes(fill = sample), alpha = 0.1)+
theme_light(base_size = 18)+
ylab('Signal Intensity')+
xlab('Retention Time (Minutes)')+
theme(legend.position = 'none')+
scale_fill_manual(values = c('orange','forestgreen'))+scale_color_manual(values = c('orange','forestgreen'))+
theme(axis.text.y = element_blank())+
theme(legend.position = 'bottom', legend.title = element_blank())+
ylim(c(-150,150))
ggplot(df3[df3$RT > 0.7 & df3$RT < 12,],
aes(x = RT, y = display.value))+
geom_line(size = 0.5, aes(col = sample))+
geom_area(aes(fill = sample), alpha = 0.1)+
theme_light(base_size = 18)+
ylab('Signal Intensity')+
xlab('Retention Time (Minutes)')+
scale_fill_manual(values = c('orange','forestgreen'))+scale_color_manual(values = c('orange','forestgreen'))+
theme(axis.text.y = element_blank())+
theme(legend.position = 'bottom', legend.title = element_blank())+
ylim(c(-150,150))
df3 <- df1[df1$sample %in% c('1030.1','1039.3'),]
df3$display.value <- ifelse(df3$sample=='1030.1', df3$Value, df3$Value*-1)
ggplot(df3[df3$RT > 0.7 & df3$RT < 12,],
aes(x = RT, y = display.value))+
geom_line(size = 0.5, aes(col = sample))+
geom_area(aes(fill = sample), alpha = 0.1)+
theme_light(base_size = 18)+
ylab('Signal Intensity')+
xlab('Retention Time (Minutes)')+
scale_fill_manual(values = c('orange','forestgreen'))+scale_color_manual(values = c('orange','forestgreen'))+
theme(axis.text.y = element_blank())+
theme(legend.position = 'bottom', legend.title = element_blank())+
ylim(c(-150,150))
