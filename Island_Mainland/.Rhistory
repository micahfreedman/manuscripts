rayleigh.test(all_trials[all_trials$Population == 'E' & all_trials$Cohort == 2,]$Vector_Direction)
rayleigh.test(all_trials[all_trials$Population == 'E',]$Vector_Direction)
rayleigh.test(all_trials[all_trials$Population == 'H',]$Vector_Direction)
nrow(all_trials)
rayleigh.test(all_trials[all_trials$Population == 'E' & all_trials$Cohort == 2,]$Vector_Direction)
h2.mean <- Find_group_mean("~/Desktop/2020_monarch_orientation/H2_all.csv")
H2.all.trials <- ggplot(all_trials[all_trials$Population == 'H' & all_trials$Cohort == 2,],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
geom_bar(stat = 'identity', aes(x = h2.mean[[2]], y = h2.mean[[1]]/100), width = 0.3, col = 'red')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('North American Autumn')+theme(plot.title = element_text(size = 16, hjust = 0.5))
H2.all.trials
H2.all.trials <- ggplot(all_trials[all_trials$Population == 'H' & all_trials$Cohort == 2,],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
geom_bar(stat = 'identity', aes(x = h2.mean[[2]], y = h2.mean[[1]]/100), width = 0.3, col = 'red')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('Hybrid Autumn')+theme(plot.title = element_text(size = 16, hjust = 0.5))
H2.all.trials
rayleigh.test(all_trials[all_trials$Population == 'H' & all_trials$Cohort == 2,]$Vector_Direction)
data$Date
library(lubridate)
data$Date <- as.character(data$Date)
for (i in 1:length(data$Date)){
data$month[i] <- strsplit(data$Date, "-")[[i]][[1]]
}
data$month <- str_replace(data$month, "Sept", "Sep")
for (i in 1:length(data$Date)){
data$day[i] <- strsplit(data$Date, "-")[[i]][[2]]
}
data$year <- 2020
data$Date <- as.Date(paste(match(data$month, month.abb), data$day, data$year, sep = "/"), format = "%m/%d/%Y")
#######
peak_migration <- data[data$Date > "2020-08-28" & data$Date < "2020-10-04" & data$Population == 'E',]
#write.csv(peak_migration, file = '~/Desktop/2020_monarch_orientation/peak_migration.csv', row.names = F)
#######
#split up data into trials that went south (regardless of magnitude) vs. those that didn't
ind.monarchs <- read.csv('~/Downloads/2020_monarchs_IDs.csv')
combined.orientation <- merge(ind.monarchs, Data, by = 'ID')
combined.orientation$OE.binary <- ifelse(combined.orientation$OE %in% c('x','xx',0), 0, 1)
combined.orientation$Eclosion_Date <- as.Date(paste(combined.orientation$Eclosion_Date, 2020, sep = "-"), format = '%d-%B-%Y')
combined.orientation$Eclosion_Date.julian <- julian(combined.orientation$Eclosion_Date, origin = as.Date("2020-07-01"))
library(lme4)
combined.orientation$southie <- ifelse(combined.orientation$Vector_Direction < 270 & combined.orientation$Vector_Direction > 90, 1, 0)
south.model <- glmer(southie ~  Population.x + scale(Eclosion_Date.julian) + (1|ID), data = combined.orientation, family = 'binomial')
combined.orientation
combined.orientation$southie
combined.orientation$southie <- ifelse(combined.orientation$Vector_Direction < 270 & combined.orientation$Vector_Direction > 90, 1, 0)
combined.orientation$southie
nrow(combined.orientation)
Data = all_trials
ind.monarchs <- read.csv('~/Downloads/2020_monarchs_IDs.csv')
combined.orientation <- merge(ind.monarchs, Data, by = 'ID')
combined.orientation$OE.binary <- ifelse(combined.orientation$OE %in% c('x','xx',0), 0, 1)
combined.orientation$Eclosion_Date <- as.Date(paste(combined.orientation$Eclosion_Date, 2020, sep = "-"), format = '%d-%B-%Y')
combined.orientation$Eclosion_Date.julian <- julian(combined.orientation$Eclosion_Date, origin = as.Date("2020-07-01"))
library(lme4)
combined.orientation$southie <- ifelse(combined.orientation$Vector_Direction < 270 & combined.orientation$Vector_Direction > 90, 1, 0)
combined.orientation$southie
south.model <- glmer(southie ~  Population.x + scale(Eclosion_Date.julian) + (1|ID), data = combined.orientation, family = 'binomial')
summary(south.model)
names(stats_orientation)
stats_orientation$Date
paste(stats_orientation$Date)
paste(stats_orientation$Date, stats_orientation$ID, sep = ".")
stats_orientation$merger.ID <- paste(stats_orientation$Date, stats_orientation$ID, sep = ".")
combined.orientation$merger.ID <- paste(combined.orientation$Date, combined.orientation$ID, sep = ".")
combined.orientation$merger.ID
merge(stats_orientation, combined.orientation, by = 'merger.ID')
combined.orientation2 <- merge(combined.orientation, stats_orientation, by = 'merger.ID')
names(combined.orientation2)
combined.orientation2 <- merge(combined.orientation, stats_orientation, 'merger.ID')
combined.orientation2
names(combined.orientation2)
nrow(combined.orientation)
south.model <- glmer(southie ~  Population.x + scale(Eclosion_Date.julian) + daylength + (1|ID), data = combined.orientation, family = 'binomial')
summary(south.model)
names(combined.orientation2)
south.model <- glmer(southie ~  Population.x + scale(Eclosion_Date.julian) + daylength + HourlyWindDirection + (1|ID), data = combined.orientation, family = 'binomial')
south.model <- glmer(southie ~  Population.x + scale(Eclosion_Date.julian) + daylength + HourlyWindSpeed + (1|ID), data = combined.orientation2, family = 'binomial')
south.model <- glmer(southie ~  Population.x + scale(Eclosion_Date.julian) + daylength + HourlyWindSpeed + (1|ID.x), data = combined.orientation2, family = 'binomial')
summary(south.model)
names(combined.orientation2)
south.model <- glmer(southie ~  Population.x + scale(Eclosion_Date.julian) + daylength + HourlyWindSpeed + (1|ID.x) + (1|Mom.x), data = combined.orientation2, family = 'binomial')
summary(south.model)
south.model <- glmer(southie ~  Population.x + scale(Eclosion_Date.julian) + daylength + HourlyWindSpeed + (1|ID.x) + (1|Mom.x) + HourlyDryBulbTemperature, data = combined.orientation2, family = 'binomial')
summary(south.model)
south.model <- glmer(southie ~  Population.x + scale(Eclosion_Date.julian) + daylength + HourlyWindSpeed + (1|ID.x) + (1|Mom.x) + scale(HourlyDryBulbTemperature), data = combined.orientation2, family = 'binomial')
summary(south.model)
combined.orientation$Cohort
south.model <- glmer(southie ~  Population.x + scale(Eclosion_Date.julian) + daylength + HourlyWindSpeed + (1|ID.x) + (1|Mom.x) + scale(HourlyDryBulbTemperature), data = combined.orientation2[combined.orientation2$Cohort==2,], family = 'binomial')
summary(south.model)
names(combined.orientation2)
south.model <- glmer(southie ~  Population.x + scale(Eclosion_Date.julian) + daylength + HourlyWindSpeed + (1|ID.x) + (1|Mom.x) + scale(HourlyDryBulbTemperature) + OE.binary, data = combined.orientation2[combined.orientation2$Cohort==2,], family = 'binomial')
summary(south.model)
south.model <- glmer(southie ~  Population.x + scale(Eclosion_Date.julian) + daylength + HourlyWindSpeed + (1|ID.x) + (1|Mom.x) + scale(HourlyDryBulbTemperature) + OE.binary + Sex.x, data = combined.orientation2[combined.orientation2$Cohort==2,], family = 'binomial')
summary(south.model)
logit2prob(2.237+0.515)
table(combined.orientation$southie, combined.orientation$Population.x)
147+92
147/329
147/239
43/88
45/88
south.model <- glmer(southie ~  Population.x + (1|ID.x) + (1|Mom.x) + Sex.x, data = combined.orientation2[combined.orientation2$Cohort==2,], family = 'binomial')
summary(south.model)
logit2prob(0.09544+.43950)
library(emmeans)
library(glht)
library(multcomp)
glht(south.model, linfct = mcp('Population.x'))
glht(south.model, linfct = mcp(Population.x = 'Tukey'))
summary(glht(south.model, linfct = mcp(Population.x = 'Tukey')))
summary(south.model)
logit2prob(0.09544+0.43950)
logit2prob(0.09544)
logit2prob(0.09544+0.43950+.29839)
south.model <- glmer(southie ~  Population.x + (1|ID.x) + (1|Mom.x), data = combined.orientation2[combined.orientation2$Cohort==2,], family = 'binomial')
summary(south.model)
library(multcomp)
summary(glht(south.model, linfct = mcp(Population.x = 'Tukey')))
summary(south.model)
logit2prob(.2021)
logit2prob(.2021+.4519)
logit2prob(.2021 - .1689)
south.model <- glmer(southie ~  Population.x + (1|ID.x) + (1|Mom.x) + (1|Date), data = combined.orientation2[combined.orientation2$Cohort==2,], family = 'binomial')
south.model <- glmer(southie ~  Population.x + (1|ID.x) + (1|Mom.x) + (1|as.factor(Date)), data = combined.orientation2[combined.orientation2$Cohort==2,], family = 'binomial')
combined.orientation2$Date.x
as.factor(combined.orientation2$Date.x)
south.model <- glmer(southie ~  Population.x + (1|ID.x) + (1|Mom.x) + (1|as.factor(Date.x)), data = combined.orientation2[combined.orientation2$Cohort==2,], family = 'binomial')
combined.orientation2$factor.date <- as.factor(combined.orientation2$Date.x)
south.model <- glmer(southie ~  Population.x + (1|ID.x) + (1|Mom.x) + (1|factor.date), data = combined.orientation2[combined.orientation2$Cohort==2,], family = 'binomial')
summary(south.model)
logit2prob(.2434+.426)
logit2prob(.2434)
logit2prob(.2434-.1949)
nrow(ind.monarchs)
summary(lmer(Eclosion_Mass ~ Sex + Population*oe.binary + scale(daylength_at_eclosion) + (1|Mom), data = f2s[f2s$Generation == 2,])
)
library(ggplot2)
library(plyr)
f2s <- read.csv('~/Downloads/2020_monarchs_IDs.csv')
head(f2s)
f2s$Population <- factor(f2s$Population, levels = c('North_America','Puerto_Rico','Hybrid'))
medians <- aggregate(Eclosion_Mass ~ Population, f2s, median)
ggplot(f2s, aes(x = Eclosion_Mass))+
geom_density(aes(col = Population, fill = Population), size = 1, alpha = 0.3)+
facet_wrap(~Population, nrow = 3)+
theme_classic()+
theme(legend.position = 'none')+
scale_color_manual(values = c('gold','red','blue'))+
scale_fill_manual(values = c('gold','red','blue'))+
geom_vline(data = medians, aes(xintercept = Eclosion_Mass, col = Population), lty = 2)+
theme(text = element_text(size = 15))
ggplot(f2s, aes(x = Eclosion_Mass*1000))+
geom_histogram(aes(col = Population, fill = Population), size = 1, alpha = 0.3)+
facet_wrap(~Population, nrow = 3)+
theme_classic()+
theme(legend.position = 'none')+
scale_color_manual(values = c('gold','red','blue'))+
scale_fill_manual(values = c('gold','red','blue'))+
geom_vline(data = medians, aes(xintercept = Eclosion_Mass*1000), lty = 2, size = 1)+
theme(text = element_text(size = 15))+
xlab("Eclosion Mass (mg)")+
theme(axis.title.y = element_blank())+
theme(strip.background = element_rect(fill = 'grey95'))
f2s$oe.binary <- ifelse(f2s$OE == 'xxx', 1, 0)
f2s$Eclosion_Date <- as.Date(paste(f2s$Eclosion_Date, 2020, sep = "-"), format = '%d-%B-%Y')
f2s$Eclosion_Date.julian <- julian(f2s$Eclosion_Date, origin = as.Date("2020-07-01"))
f2s$daylength_at_eclosion <- daylength(41.8781, f2s$Eclosion_Date)
eclosion.mass.model <- lmer(Eclosion_Mass ~ Sex + Population + scale(daylength_at_eclosion) + oe.binary + (1|Mom), data = f2s[f2s$Generation == 2,])
summary(eclosion.mass.model)
eclosion.mass.model <- lmer(Eclosion_Mass ~ Sex + Population*oe.binary + scale(daylength_at_eclosion) + (1|Mom), data = f2s[f2s$Generation == 2,])
summary(eclosion.mass.model)
eclosion.mass.model <- lmer(Eclosion_Mass ~ Sex + Population + oe.binary + scale(daylength_at_eclosion) + (1|Mom), data = f2s[f2s$Generation == 2,])
summary(eclosion.mass.model)
?sunAngle?
()
?sunAngle
sunAngle(stats_orientation$date_time, latitude = 41)
sunAngle(stats_orientation$date_time, latitude = 41)[[3]]
stats_orientation$sun_angle_altitude <- sunAngle(stats_orientation$date_time, latitude = 41.8781, longitude = 87.6298)[[3]]
stats_orientation$sun_angle_altitude <- replace(stats_orientation$sun_angle_altitude, which(stats_orientation$sun_angle_altitude < 0), NA)
hist(stats_orientation$sun_angle_altitude, breaks = 25, main = 'Sun Angle at Time of Trial')
hist(stats_orientation$HourlyWindSpeed, breaks = 20, main = 'Wind Speed (MPH) at Time of Trial')
model1 <- glmer(trial_success ~ population + scale(HourlyWindSpeed) + scale(HourlyDryBulbTemperature) + scale(HourlyRelativeHumidity) + scale(sun_angle_altitude) + scale(HourlyStationPressure) + scale(age_during_trial) + Sex + oe.binary + (1|Mom) + (1|ID), data = dat.mod1, family = 'binomial')
summary(model1)
dat.mod1 <- na.omit(stats_orientation[stats_orientation$cohort==2,])
model1 <- glmer(trial_success ~ population + scale(HourlyWindSpeed) + scale(HourlyDryBulbTemperature) + scale(HourlyRelativeHumidity) + scale(sun_angle_altitude) + scale(HourlyStationPressure) + scale(age_during_trial) + Sex + oe.binary + (1|Mom) + (1|ID), data = dat.mod1, family = 'binomial')
summary(model1)
dat.mod1$fitted <- fitted(model1)
aggregate(fitted ~ population, mean, data = dat.mod1)
logit2prob <- function(logit){
odds <- exp(logit)
prob <- odds / (1 + odds)
return(prob)
}
ranef(south.model)
ranef(south.model)[[1]][[1]]
summary(south.model)[[10]][1])
summary(south.model)[[10]][1]
hist(logit2prob(ranef(south.model)[[1]][[1]] + summary(south.model)[[10]][1]), breaks = 25) #distribution of southward flight probabilities for each individual monarch
hist(logit2prob(ranef(south.model)[[1]][[1]] + summary(south.model)[[10]][1]), breaks = 40) #distribution of southward flight probabilities for each individual monarch
hist(fitted(south.model))
hist(fitted(south.model), breaks = 40, main = 'Probability of Southward Flight')
combined.orientation2$south.fitted <- fitted(south.model)
combined.orientation2 <- combined.orientation2[combined.orientation2$Cohort ==2,]
south.model <- glmer(southie ~  Population.x + (1|ID.x) + (1|Mom.x) + (1|factor.date), data = combined.orientation2, family = 'binomial')
combined.orientation2$south.fitted <- fitted(south.model)
ggplot(combined.orientation2, aes(x = south.fitted))+
geom_histogram()+
facet_wrap(~Population.x)
ggplot(combined.orientation2, aes(x = south.fitted))+
geom_histogram()+
facet_wrap(~Population.x, nrow = 3)
ggplot(combined.orientation2, aes(x = south.fitted))+
geom_histogram(aes(fill = Population.x))+
facet_wrap(~Population.x, nrow = 3)+
theme(bw)
ggplot(combined.orientation2, aes(x = south.fitted))+
geom_histogram(aes(fill = Population.x))+
facet_wrap(~Population.x, nrow = 3)+
theme_classic()
ggplot(combined.orientation2, aes(x = south.fitted))+
geom_histogram(aes(fill = Population.x))+
facet_wrap(~Population.x, nrow = 3)+
theme_classic()+
theme(legend.position = NA)
ggplot(combined.orientation2, aes(x = south.fitted))+
geom_histogram(aes(fill = Population.x))+
facet_wrap(~Population.x, nrow = 3)+
theme_classic()+
theme(legend.position = 'none')
ggplot(combined.orientation2, aes(x = south.fitted))+
geom_histogram(aes(fill = Population.x))+
facet_wrap(~Population.x, nrow = 3)+
theme_classic()+
theme(legend.position = 'none')+
scale_fill_manual(values = 'blue','gold','red')
ggplot(combined.orientation2, aes(x = south.fitted))+
geom_histogram(aes(fill = Population.x))+
facet_wrap(~Population.x, nrow = 3)+
theme_classic()+
theme(legend.position = 'none')+
scale_fill_manual(values = c('blue','gold','red'))
ggplot(combined.orientation2, aes(x = south.fitted))+
geom_histogram(aes(fill = Population.x))+
facet_wrap(~Population.x, nrow = 3)+
theme_classic()+
theme(legend.position = 'none', strip.background = element_rect(fill = 'gray90'))+
scale_fill_manual(values = c('blue','gold','red'))
ggplot(combined.orientation2, aes(x = south.fitted))+
geom_histogram(aes(fill = Population.x))+
facet_wrap(~Population.x, nrow = 3)+
theme_classic()+
theme(legend.position = 'none', strip.background = element_rect(fill = 'gray90'))+
scale_fill_manual(values = c('blue','gold','red'))+
xlab('Probability of Southward Flight Orientation (90-270)')
ggplot(combined.orientation2, aes(x = south.fitted))+
geom_histogram(aes(fill = Population.x))+
facet_wrap(~Population.x, nrow = 3)+
theme_classic()+
theme(legend.position = 'none', strip.background = element_rect(fill = 'gray90'))+
scale_fill_manual(values = c('blue','gold','red'))+
xlab('Probability of Southward Orientation (90-270)')
ggplot(combined.orientation2, aes(x = south.fitted))+
geom_histogram(aes(fill = Population.x))+
facet_wrap(~Population.x, nrow = 3)+
theme_classic()+
theme(legend.position = 'none', strip.background = element_rect(fill = 'gray90'))+
scale_fill_manual(values = c('blue','gold','red'))+
xlab('Probability of Southward Orientation (90-270)')+
geom_vline(xintercept = 0.5)
watson.two(E2.all.trials$R, P2.all.trials$R)
watson.two(all_trials[all_trials$Population=='E' & all_trials$Cohort == 2,]$R, all_trials[all_trials$Population=='P' & all_trials$Cohort == 2,]$R)
watson.two(all_trials[all_trials$Population=='E' & all_trials$Cohort == 2,]$R, all_trials[all_trials$Population=='H' & all_trials$Cohort == 2,]$R)
nrow(all_trials[all_trials$Population=='P' & all_trials$Cohort == 1,])
length(unique(all_trials[all_trials$Population=='P' & all_trials$Cohort == 1,]$ID))
length(unique(all_trials[all_trials$Population=='P' & all_trials$Cohort == 2,]$ID))
nrow(all_trials[all_trials$Population=='P' & all_trials$Cohort == 2,])
nrow(all_trials[all_trials$Population=='E' & all_trials$Cohort == 2,])
length(unique(all_trials[all_trials$Population=='E' & all_trials$Cohort == 2,]$ID))
length(unique(all_trials[all_trials$Population=='H' & all_trials$Cohort == 2,]$ID))
nrow(all_trials[all_trials$Population=='H' & all_trials$Cohort == 2,])
ggplot(all_trials[all_trials$Population == 'E' & all_trials$Cohort == 2,],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
geom_bar(stat = 'identity', aes(x = e2.mean[[2]], y = e2.mean[[1]]/100), width = 0.3, col = 'red')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('North American Autumn')+theme(plot.title = element_text(size = 16, hjust = 0.5))
combined.orientation2$Eclosion_Date.x
names(combined.orientation2)
ggplot(combined.orientation2[combined.orientation2$Population == 'E' & combined.orientation2$Cohort == 2 & combined.orientation2$Eclosion_Date.x > '2020-10-03',],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
geom_bar(stat = 'identity', aes(x = e2.mean[[2]], y = e2.mean[[1]]/100), width = 0.3, col = 'red')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('North American Autumn')+theme(plot.title = element_text(size = 16, hjust = 0.5))
ggplot(combined.orientation2[combined.orientation2$Population == 'E' & combined.orientation2$Cohort == 2 & combined.orientation2$Eclosion_Date.x > '2020-10-03',],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('North American Autumn')+theme(plot.title = element_text(size = 16, hjust = 0.5))
combined.orientation2$Vector_Direction
combined.orientation2$R
combined.orientation2[combined.orientation2$Population == 'E' & combined.orientation2$Cohort == 2 & combined.orientation2$Eclosion_Date.x > '2020-10-03',]
combined.orientation2[combined.orientation2$Population == 'E' & combined.orientation2$Cohort == 2 & combined.orientation2$Eclosion_Date.x > as.Date('2020-10-03'),]
combined.orientation2$Eclosion_Date.x
combined.orientation2[combined.orientation2$Eclosion_Date.x > "2020-10-06",]
combined.orientation2[combined.orientation2$Population == 'E' & combined.orientation2$Cohort == 2 & combined.orientation2$Eclosion_Date.x > "2020-10-03",]
combined.orientation2[combined.orientation2$Population.x == 'E' & combined.orientation2$Cohort == 2 & combined.orientation2$Eclosion_Date.x > "2020-10-03",]
combined.orientation2[combined.orientation2$Population.x == 'E' & combined.orientation2$Cohort == 2 & combined.orientation2$Eclosion_Date.x > "2020-10-03",]
combined.orientation2[combined.orientation2$Population.x == 'E' & combined.orientation2$Generation.x == 2 & combined.orientation2$Eclosion_Date.x > "2020-10-03",]
lates <- combined.orientation2[combined.orientation2$Eclosion_Date.x > "2020-10-03",]
lates
ggplot(lates[lates$Population == 'E' & lates$Cohort == 2,],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('North American Autumn')+theme(plot.title = element_text(size = 16, hjust = 0.5))
lates[lates$Population == 'E' & lates$Cohort == 2,]
ggplot(lates[lates$Population.x == 'E' & lates$Cohort == 2,],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('North American Autumn')+theme(plot.title = element_text(size = 16, hjust = 0.5))
ggplot(lates[lates$Population.x == 'E' & lates$Generation.x == 2,],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('North American Autumn')+theme(plot.title = element_text(size = 16, hjust = 0.5))
ggplot(all_trials[all_trials$Population == 'E' & all_trials$Cohort == 2,],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
geom_bar(stat = 'identity', aes(x = e2.mean[[2]], y = e2.mean[[1]]/100), width = 0.3, col = 'red')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('North American Autumn')+theme(plot.title = element_text(size = 16, hjust = 0.5))
lates[lates$Population.x == 'E' & lates$Generation.x == 2,]
lates$Generation.x
lates[lates$Population.x == 'E',]
lates$Population.x
lates[lates$Population.x == 'North_America',]
ggplot(lates[lates$Population.x == 'North_America',],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('North American Autumn')+theme(plot.title = element_text(size = 16, hjust = 0.5))
E2.all.trials <- ggplot(all_trials[all_trials$Population == 'E' & all_trials$Cohort == 2,],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
geom_bar(stat = 'identity', aes(x = e2.mean[[2]], y = e2.mean[[1]]/100), width = 0.3, col = 'red')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('North America Post 10/3 Eclosion')+theme(plot.title = element_text(size = 16, hjust = 0.5))
ggplot(lates[lates$Population.x == 'North_America',],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('North American Post-10/3 Emergences')+theme(plot.title = element_text(size = 16, hjust = 0.5))
lates[lates$Population.x == 'North_America',]
lates.nam = lates[lates$Population.x == 'North_America',]
Data = lates.nam
meanvec=na.omit(Data$Vec)
Rs=na.omit(Data$R)
meanvec_radians = rad(meanvec)
X_coord = cos(meanvec_radians)
Y_coord = sin(meanvec_radians)
weighted_X_coord = X_coord * Rs
weighted_Y_coord = Y_coord * Rs
Data$X <- weighted_X_coord
Data$Y <- weighted_Y_coord
write.csv(Data, file = '~/Desktop/2020_monarch_orientation/later.E2', row.names = F)
Find_group_mean("~/Desktop/2020_monarch_orientation/later.E2.csv")
write.csv(Data, file = '~/Desktop/2020_monarch_orientation/later.E2.csv', row.names = F)
Find_group_mean("~/Desktop/2020_monarch_orientation/later.E2.csv")
which(lates.nam$Vector_Direction > 0 & lates.nam$Vector_Direction < 10)
lates.nam[which(lates.nam$Vector_Direction > 0 & lates.nam$Vector_Direction < 10),]
bbz <- combined.orientation2[combined.orientation2$age_during_trial < 14,]
ggplot(bbz[bbz$Population == 'E' & all_trials$Cohort == 2,],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('Babies Autumn')+theme(plot.title = element_text(size = 16, hjust = 0.5))
bbz
table(bbz$population)
ggplot(bbz[bbz$Population.x == 'E' & bbz$Generation.x == 2,],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('Babies Autumn')+theme(plot.title = element_text(size = 16, hjust = 0.5))
bbz$Population.x
ggplot(bbz[bbz$population == 'E' & bbz$Generation.x == 2,],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('Babies Autumn')+theme(plot.title = element_text(size = 16, hjust = 0.5))
bbz <- combined.orientation2[combined.orientation2$age_during_trial < 10,]
ggplot(bbz[bbz$population == 'E' & bbz$Generation.x == 2,],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('Babies Autumn')+theme(plot.title = element_text(size = 16, hjust = 0.5))
bbz <- combined.orientation2[combined.orientation2$age_during_trial > 20,]
ggplot(bbz[bbz$population == 'E' & bbz$Generation.x == 2,],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('Babies Autumn')+theme(plot.title = element_text(size = 16, hjust = 0.5))
bbz <- combined.orientation2[combined.orientation2$age_during_trial > 30,]
ggplot(bbz[bbz$population == 'E' & bbz$Generation.x == 2,],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('Babies Autumn')+theme(plot.title = element_text(size = 16, hjust = 0.5))
bbz <- combined.orientation2[combined.orientation2$age_during_trial > 40,]
ggplot(bbz[bbz$population == 'E' & bbz$Generation.x == 2,],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('Babies Autumn')+theme(plot.title = element_text(size = 16, hjust = 0.5))
View(age.models)
View(d)
data = read.csv(file = '~/Downloads/monarchs_gbif.csv')
dat2 <- read.csv("~/Downloads/monarchs_gbif.csv", header=T, na.strings=c("","NA"))
head(dat2)
write.csv(dat2, '~/Desktop/monarchs_gbif.csv')
library(ggplot2)
library(lme4)
library(plyr)
library(rworldmap)
library(MuMIn)
library(car)
library(lsmeans)
library(multcomp)
library(sjPlot)
library(AICcmodavg)
library(stringr)
library(PerformanceAnalytics)
library(lmerTest)
library(svglite)
library(gridExtra)
library(cowplot)
options(contrasts=c("contr.sum", "contr.poly"))
wings <- read.csv(file="~/Downloads/North_American_wings.csv",header=TRUE)
library(plyr)
library(lme4)
library(emmeans)
library(ggplot2)
library(lmerTest)
library(dplyr)
library(merTools)
setwd("~/Documents/GitHub/Sites/manuscripts/Island_Mainland/")
leaf.data <- read.csv(file = "./data_files/chaparral_leaf_morphology.csv", header = T)
head(leaf.data) #dataframe with 5664 rows, each corresponding to a measurement from a single leaf
table(leaf.data$IM)
